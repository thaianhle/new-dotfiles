(()=>{var e={189:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),o=0;o<n.length;o++)"default"!==n[o]&&i(t,e,n[o]);return s(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.AddSelectionToPreviousFindMatch=t.AddSelectionToNextFindMatch=void 0;const a=o(n(398)),c=n(59);class l extends c.EmacsCommand{constructor(){super(...arguments),this.id="addSelectionToNextFindMatch"}run(e,t,n){return this.emacsController.enterMarkMode(!1),a.commands.executeCommand("editor.action.addSelectionToNextFindMatch")}}t.AddSelectionToNextFindMatch=l;class u extends c.EmacsCommand{constructor(){super(...arguments),this.id="addSelectionToPreviousFindMatch"}run(e,t,n){return this.emacsController.enterMarkMode(!1),a.commands.executeCommand("editor.action.addSelectionToPreviousFindMatch")}}t.AddSelectionToPreviousFindMatch=u},763:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),o=0;o<n.length;o++)"default"!==n[o]&&i(t,e,n[o]);return s(t,e),t}),a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.TransformToTitlecase=t.TransformToLowercase=t.TransformToUppercase=void 0;const c=o(n(398)),l=n(59);function u(e){return e.selections.some((e=>!e.isEmpty))}class d extends l.EmacsCommand{constructor(){super(...arguments),this.id="transformToUppercase"}run(e,t,n){return a(this,void 0,void 0,(function*(){u(e)||(yield this.emacsController.runCommand("forwardWord")),yield c.commands.executeCommand("editor.action.transformToUppercase")}))}}t.TransformToUppercase=d;class h extends l.EmacsCommand{constructor(){super(...arguments),this.id="transformToLowercase"}run(e,t,n){return a(this,void 0,void 0,(function*(){u(e)||(yield this.emacsController.runCommand("forwardWord")),yield c.commands.executeCommand("editor.action.transformToLowercase")}))}}t.TransformToLowercase=h;class m extends l.EmacsCommand{constructor(){super(...arguments),this.id="transformToTitlecase"}run(e,t,n){return a(this,void 0,void 0,(function*(){u(e)||(yield this.emacsController.runCommand("forwardWord")),yield c.commands.executeCommand("editor.action.transformToTitlecase")}))}}t.TransformToTitlecase=m},237:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.DeleteBlankLines=void 0;const i=n(398),s=n(59);class o extends s.EmacsCommand{constructor(){super(...arguments),this.id="deleteBlankLines"}run(e,t,n){return r(this,void 0,void 0,(function*(){const t=e.document;for(let n=0;n<e.selections.length;++n){const r=e.selections[n],s=r.active.line;if(-1!==t.lineAt(s).text.substr(r.active.character).search(/\S/))break;let o=0;for(;s+o+1<t.lineCount&&t.lineAt(s+o+1).isEmptyOrWhitespace;)o++;let a=0;for(;s-a-1>=0&&t.lineAt(s-a-1).isEmptyOrWhitespace;)a++;yield e.edit((e=>{if(o>0){const n=s+o;e.delete(new i.Range(new i.Position(s+1,0),t.lineAt(n).rangeIncludingLineBreak.end))}if(a>0){const n=s-a;e.delete(new i.Range(new i.Position(n,0),t.lineAt(s-1).rangeIncludingLineBreak.end))}}))}}))}}t.DeleteBlankLines=o},691:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),o=0;o<n.length;o++)"default"!==n[o]&&i(t,e,n[o]);return s(t,e),t}),a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.NewLine=t.DeleteHorizontalSpace=t.DeleteForwardChar=t.DeleteBackwardChar=void 0;const c=o(n(398)),l=n(398),u=n(59),d=n(11),h=n(40),m=n(185),g=n(614);class p extends u.EmacsCommand{constructor(){super(...arguments),this.id="deleteBackwardChar"}run(e,t,n){const r=void 0===n?1:n;return(0,u.makeParallel)(r,(()=>c.commands.executeCommand("deleteLeft")))}}t.DeleteBackwardChar=p;class f extends u.EmacsCommand{constructor(){super(...arguments),this.id="deleteForwardChar"}run(e,t,n){const r=void 0===n?1:n;return(0,u.makeParallel)(r,(()=>c.commands.executeCommand("deleteRight")))}}t.DeleteForwardChar=f;class v extends u.EmacsCommand{constructor(){super(...arguments),this.id="deleteHorizontalSpace"}run(e,t,n){const r=void 0!==n&&n>0;return e.edit((t=>{e.selections.forEach((n=>{const i=n.active.line;let s=n.active.character;for(;s>0;){const t=e.document.getText(new l.Range(i,s-1,i,s));if(" "!==t&&"\t"!==t)break;s-=1}let o=n.active.character;if(!r){const t=e.document.lineAt(i).range.end.character;for(;o<t;){const t=e.document.getText(new l.Range(i,o,i,o+1));if(" "!==t&&"\t"!==t)break;o+=1}}t.delete(new l.Range(i,s,i,o))}))})).then((e=>{e||g.logger.warn("deleteHorizontalSpace failed")})).then((()=>{(0,d.makeSelectionsEmpty)(e)}))}}t.DeleteHorizontalSpace=v;class x extends u.EmacsCommand{constructor(){super(...arguments),this.id="newLine"}run(e,t,n){return a(this,void 0,void 0,(function*(){this.emacsController.exitMarkMode(),e.selections=e.selections.map((e=>new l.Selection(e.active,e.active)));const t=void 0===n?1:n;if(t<=0)return;if(1===t)return c.commands.executeCommand("default:type",{text:"\n"});const r=e.selections.map((t=>t.active.isEqual(e.document.lineAt(t.active.line).range.end)));yield c.commands.executeCommand("default:type",{text:"\n"}),yield(0,m.delay)(33),yield c.commands.executeCommand("default:type",{text:"\n"});const i=e.selections.map((t=>{const n=e.document.lineAt(t.active.line-2).range.end,r=e.document.lineAt(t.active.line-1).range.end;return e.document.getText(new l.Range(n,r))})),s=e.selections.map((t=>{const n=e.document.lineAt(t.active.line-1).range.end,r=e.document.lineAt(t.active.line-0).range.end;return e.document.getText(new l.Range(n,r))})),o=e.selections.map(((t,n)=>{const i=r[n];return null!=i&&!0!==i&&t.active.isEqual(e.document.lineAt(t.active.line).range.end)})),a=e.selections.map(((t,n)=>{const r=o[n];if(null==r||!1===r)return"";const i=e.document.lineAt(t.active.line+1).range.start;return e.document.getText(new l.Range(t.active,i))}));yield c.commands.executeCommand("undo"),yield c.commands.executeCommand("undo"),yield e.edit((n=>{e.selections.forEach(((e,r)=>{const o=i[r],c=s[r],l=a[r];if(null==o)throw new Error("firstInsertedLineText is null");if(null==c)throw new Error("secondInsertedLineText is null");if(null==l)throw new Error("trailingLineText is null");n.insert(e.active,o.repeat(t-1)+c+l)}))})),e.selections=e.selections.map(((t,n)=>{if(o[n]){const n=e.document.lineAt(t.active.line-1).range.end;return new l.Selection(n,n)}return t})),(0,h.revealPrimaryActive)(e)}))}}t.NewLine=x},880:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),o=0;o<n.length;o++)"default"!==n[o]&&i(t,e,n[o]);return s(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.IsearchExit=t.IsearchAbort=t.QueryReplaceRegexp=t.QueryReplace=t.IsearchBackwardRegexp=t.IsearchForwardRegexp=t.IsearchBackward=t.IsearchForward=void 0;const a=o(n(398)),c=n(59),l=n(247),u=n(40),d=n(74);class h extends c.EmacsCommand{constructor(e,t){super(e),this.searchState=t}openFindWidget(e){const{isRegex:t,replaceString:n}=e,r={searchString:void 0,replaceString:n,isRegex:t,matchWholeWord:!1,isCaseSensitive:!1,preserveCase:!1},{seedSearchStringFromSelection:i}=d.WorkspaceConfigCache.get("editor.find");return"never"===i?a.commands.executeCommand("editor.actions.findWithArgs",r):a.commands.executeCommand("editor.actions.findWithArgs",Object.assign(Object.assign({},r),{searchString:""})).then((()=>a.commands.executeCommand("editor.actions.findWithArgs",r)))}}t.IsearchForward=class extends h{constructor(){super(...arguments),this.id="isearchForward"}run(e,t,n){return this.searchState.startSelections=e.selections,this.openFindWidget({isRegex:!1}).then((()=>a.commands.executeCommand("editor.action.nextMatchFindAction")))}},t.IsearchBackward=class extends h{constructor(){super(...arguments),this.id="isearchBackward"}run(e,t,n){return this.searchState.startSelections=e.selections,this.openFindWidget({isRegex:!1}).then((()=>a.commands.executeCommand("editor.action.previousMatchFindAction")))}},t.IsearchForwardRegexp=class extends h{constructor(){super(...arguments),this.id="isearchForwardRegexp"}run(e,t,n){return this.searchState.startSelections=e.selections,this.openFindWidget({isRegex:!0}).then((()=>a.commands.executeCommand("editor.action.nextMatchFindAction")))}},t.IsearchBackwardRegexp=class extends h{constructor(){super(...arguments),this.id="isearchBackwardRegexp"}run(e,t,n){return this.searchState.startSelections=e.selections,this.openFindWidget({isRegex:!0}).then((()=>a.commands.executeCommand("editor.action.previousMatchFindAction")))}},t.QueryReplace=class extends h{constructor(){super(...arguments),this.id="queryReplace"}run(e,t,n){return this.searchState.startSelections=e.selections,a.commands.executeCommand("editor.action.startFindReplaceAction")}},t.QueryReplaceRegexp=class extends h{constructor(){super(...arguments),this.id="queryReplaceRegexp"}run(e,t,n){return this.searchState.startSelections=e.selections,this.openFindWidget({isRegex:!0,replaceString:""})}},t.IsearchAbort=class extends h{constructor(){super(...arguments),this.id="isearchAbort"}run(e,t,n){return this.searchState.startSelections&&(e.selections=this.searchState.startSelections),l.MessageManager.showMessage("Quit"),(0,u.revealPrimaryActive)(e),a.commands.executeCommand("closeFindWidget")}},t.IsearchExit=class extends h{constructor(){super(...arguments),this.id="isearchExit"}run(e,t,n,r){return a.commands.executeCommand("closeFindWidget").then((()=>{const n=this.searchState.startSelections;n&&(t?e.selections=e.selections.map(((e,t)=>{const r=n[t];return null==r?e:new a.Selection(r.anchor,e.active)})):(this.emacsController.pushMark(n.map((e=>e.anchor))),l.MessageManager.showMessage("Mark saved where search started")));const i=null==r?void 0:r[0],s=null==i?void 0:i.then,o="string"==typeof s?s:void 0;if(o)return a.commands.executeCommand(o)}))}}},273:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),o=0;o<n.length;o++)"default"!==n[o]&&i(t,e,n[o]);return s(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.getEolChar=function(e){switch(e){case a.EndOfLine.CRLF:return"\r\n";case a.EndOfLine.LF:default:return"\n"}};const a=o(n(398))},539:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.travelForward=function(e,t){let n=!1,r=t.line;for(;;){const t=e.lineAt(r);if(n&&t.isEmptyOrWhitespace)break;if(t.isEmptyOrWhitespace||(n=!0),r===e.lineCount-1)break;++r}return e.lineAt(r).range.end},t.travelBackward=function(e,t){let n=!1,r=t.line;for(;;){const t=e.lineAt(r);if(n&&t.isEmptyOrWhitespace)break;if(t.isEmptyOrWhitespace||(n=!0),0===r)break;--r}return e.lineAt(r).range.start}},40:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.revealPrimaryActive=function(e){return e.revealRange(new r.Range(e.selection.active,e.selection.active))};const r=n(398)},11:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNonEmptySelections=function(e){return e.selections.filter((e=>!e.isEmpty))},t.makeSelectionsEmpty=function(e){e.selections=e.selections.map((e=>new r.Selection(e.active,e.active)))};const r=n(398)},595:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findNextWordEnd=function(e,t,n){let i=n.line,s=n.character;s===e.lineAt(i).range.end.character&&i<e.lineCount-1&&(i+=1,s=0);let o=c(e.lineAt(i).text,t,new r.Position(i,s));return o&&2===o.wordType&&i<e.lineCount-1&&o.end===e.lineAt(i).range.end.character&&(i+=1,s=0,o=c(e.lineAt(i).text,t,new r.Position(i,s))),o&&2===o.wordType&&o.end-o.start==1&&0===o.nextCharClass&&(o=c(e.lineAt(i).text,t,new r.Position(i,o.end))),s=o?o.end:e.lineAt(i).range.end.character,new r.Position(i,s)},t.findPreviousWordStart=function(e,t,n){let i=n.line,s=n.character;0===s&&i>0&&(i-=1,s=e.lineAt(i).range.end.character);let a=o(e.lineAt(i).text,t,new r.Position(i,s));return a&&2===a.wordType&&i>0&&0===a.start&&(i-=1,a=o(e.lineAt(i).text,t,e.lineAt(i).range.end)),a&&2===a.wordType&&a.end-a.start==1&&0===a.nextCharClass&&(a=o(e.lineAt(i).text,t,new r.Position(i,a.start))),new r.Position(i,a?a.start:0)};const r=n(398);function i(e,t,n,r,i){return{start:r,end:i,wordType:t,nextCharClass:n}}function s(e,t,n,r){const i=e.length;for(let s=r;s<i;s++){const r=e.charCodeAt(s),i=t.get(r);if(1===i)return s;if(1===n&&2===i)return s;if(2===n&&0===i)return s}return i}function o(e,t,n){let r=0;for(let o=n.character-1;o>=0;o--){const n=e.charCodeAt(o),a=t.get(n);if(0===a){if(2===r)return i(0,r,a,o+1,s(e,t,r,o+1));r=1}else if(2===a){if(1===r)return i(0,r,a,o+1,s(e,t,r,o+1));r=2}else if(1===a&&0!==r)return i(0,r,a,o+1,s(e,t,r,o+1))}return 0!==r?i(0,r,1,0,s(e,t,r,0)):null}function a(e,t,n,r){for(let i=r;i>=0;i--){const r=e.charCodeAt(i),s=t.get(r);if(1===s)return i+1;if(1===n&&2===s)return i+1;if(2===n&&0===s)return i+1}return 0}function c(e,t,n){let r=0;const s=e.length;for(let o=n.character;o<s;o++){const n=e.charCodeAt(o),s=t.get(n);if(0===s){if(2===r)return i(0,r,s,a(e,t,r,o-1),o);r=1}else if(2===s){if(1===r)return i(0,r,s,a(e,t,r,o-1),o);r=2}else if(1===s&&0!=r)return i(0,r,s,a(e,t,r,o-1),o)}return 0!==r?i(0,r,1,a(e,t,r,s-1),s):null}},618:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),o=0;o<n.length;o++)"default"!==n[o]&&i(t,e,n[o]);return s(t,e),t}),a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.DeleteIndentation=void 0;const c=o(n(398)),l=n(59);class u extends l.EmacsCommand{constructor(){super(...arguments),this.id="deleteIndentation"}run(e,t,n){return a(this,void 0,void 0,(function*(){yield this.emacsController.runCommand("previousLine"),yield c.commands.executeCommand("editor.action.joinLines")}))}}t.DeleteIndentation=u},59:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmacsCommand=void 0,t.makeParallel=function(e,t){return Promise.all(Array.from({length:e},t))},t.isTextEditorInterruptionHandler=function(e){return"function"==typeof e.onDidInterruptTextEditor},t.EmacsCommand=class{constructor(e){this.isIntermediateCommand=!1,this.emacsController=e}}},291:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),o=0;o<n.length;o++)"default"!==n[o]&&i(t,e,n[o]);return s(t,e),t}),a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.YankPop=t.Yank=t.CopyRegion=t.KillRegion=t.KillWholeLine=t.KillLine=t.BackwardKillWord=t.KillWord=t.KillYankCommand=void 0;const c=o(n(398)),l=n(398),u=n(59),d=n(653),h=n(915),m=n(165),g=n(595),p=n(40),f=n(11),v=n(247);function x(){const e=c.window.activeTextEditor,t=e?e.document.uri:null,n=c.workspace.getConfiguration("editor",t).wordSeparators;return(0,m.getMapForWordSeparators)("string"==typeof n?n:"")}class w extends u.EmacsCommand{constructor(e,t){super(e),this.killYanker=t}}t.KillYankCommand=w,t.KillWord=class extends w{constructor(){super(...arguments),this.id="killWord"}run(e,t,n){return a(this,void 0,void 0,(function*(){const t=void 0===n?1:n;if(t<=0)return;this.emacsController.exitMarkMode(),(0,f.makeSelectionsEmpty)(e);const r=e.selections.map((n=>function(e,t,n=1){if(n<=0)throw new Error(`Invalid repeat ${n}`);const r=x();let i=t;for(let t=0;t<n;++t)i=(0,g.findNextWordEnd)(e,r,i);const s=new l.Range(t,i);return s.isEmpty?void 0:s}(e.document,n.active,t))).filter((e=>null!=e));yield this.killYanker.kill(r,!1),(0,p.revealPrimaryActive)(e)}))}},t.BackwardKillWord=class extends w{constructor(){super(...arguments),this.id="backwardKillWord"}run(e,t,n){return a(this,void 0,void 0,(function*(){const t=void 0===n?1:n;if(t<=0)return;this.emacsController.exitMarkMode(),(0,f.makeSelectionsEmpty)(e);const r=e.selections.map((n=>function(e,t,n=1){if(n<=0)throw new Error(`Invalid repeat ${n}`);const r=x();let i=t;for(let t=0;t<n;++t)i=(0,g.findPreviousWordStart)(e,r,i);const s=new l.Range(i,t);return s.isEmpty?void 0:s}(e.document,n.active,t))).filter((e=>null!=e));yield this.killYanker.kill(r,!1,d.AppendDirection.Backward),(0,p.revealPrimaryActive)(e)}))}},t.KillLine=class extends w{constructor(){super(...arguments),this.id="killLine"}run(e,t,n){const r=h.Configuration.instance.killWholeLine;this.emacsController.exitMarkMode(),(0,f.makeSelectionsEmpty)(e);const i=e.document.lineAt(e.document.lineCount-1).range.end,s=e.selections.map((e=>e.active)).filter((e=>!e.isEqual(i)));if(0===s.length)return v.MessageManager.showMessage("End of buffer"),Promise.resolve();const o=s.map((t=>{const i=e.document.lineAt(t.line);if(void 0!==n)return new l.Range(t,new l.Position(t.line+n,0));if(r&&0===t.character)return new l.Range(t,new l.Position(t.line+1,0));const s=i.range.end;return t.isEqual(s)?new l.Range(t,new l.Position(t.line+1,0)):new l.Range(t,s)}));return this.killYanker.kill(o,!1).then((()=>(0,p.revealPrimaryActive)(e)))}},t.KillWholeLine=class extends w{constructor(){super(...arguments),this.id="killWholeLine"}run(e,t,n){this.emacsController.exitMarkMode(),(0,f.makeSelectionsEmpty)(e);const r=e.selections.map((e=>new l.Range(new l.Position(e.active.line,0),new l.Position(e.active.line+1,0))));return this.killYanker.kill(r,!1).then((()=>(0,p.revealPrimaryActive)(e)))}},t.KillRegion=class extends w{constructor(){super(...arguments),this.id="killRegion"}run(e,t,n){return a(this,void 0,void 0,(function*(){if(this.emacsController.inRectMarkMode){const e=this.emacsController.nativeSelections;yield this.killYanker.kill(e,!0)}else{const t=(0,f.getNonEmptySelections)(e);yield this.killYanker.kill(t,!1)}(0,p.revealPrimaryActive)(e),this.emacsController.exitMarkMode()}))}},t.CopyRegion=class extends w{constructor(){super(...arguments),this.id="copyRegion"}run(e,t,n){return a(this,void 0,void 0,(function*(){if(this.emacsController.inRectMarkMode){const e=this.emacsController.nativeSelections;yield this.killYanker.copy(e,!0)}else{const t=(0,f.getNonEmptySelections)(e);yield this.killYanker.copy(t,!1)}this.emacsController.exitMarkMode(),this.killYanker.cancelKillAppend(),(0,f.makeSelectionsEmpty)(e),(0,p.revealPrimaryActive)(e)}))}},t.Yank=class extends w{constructor(){super(...arguments),this.id="yank"}run(e,t,n){return a(this,void 0,void 0,(function*(){this.emacsController.pushMark(e.selections.map((e=>e.active))),yield this.killYanker.yank(),this.emacsController.exitMarkMode(),(0,p.revealPrimaryActive)(e)}))}},t.YankPop=class extends w{constructor(){super(...arguments),this.id="yankPop"}run(e,t,n){return a(this,void 0,void 0,(function*(){yield this.killYanker.yankPop(),this.emacsController.exitMarkMode(),(0,p.revealPrimaryActive)(e)}))}}},202:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),o=0;o<n.length;o++)"default"!==n[o]&&i(t,e,n[o]);return s(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.BackwardParagraph=t.ForwardParagraph=t.ScrollDownCommand=t.ScrollUpCommand=t.EndOfBuffer=t.BeginningOfBuffer=t.BackToIndentation=t.BackwardWord=t.ForwardWord=t.MoveEndOfLine=t.MoveBeginningOfLine=t.PreviousLine=t.NextLine=t.BackwardChar=t.ForwardChar=t.moveCommandIds=void 0,t.movePrimaryCursorIntoVisibleRange=R;const a=o(n(398)),c=n(59),l=n(915),u=n(539),d=n(247),h=n(40);t.moveCommandIds=["forwardChar","backwardChar","nextLine","previousLine","moveBeginningOfLine","moveEndOfLine","forwardWord","backwardWord","beginningOfBuffer","endOfBuffer","scrollUpCommand","scrollDownCommand","forwardParagraph","backwardParagraph","backToIndentation"];class m extends c.EmacsCommand{constructor(){super(...arguments),this.id="forwardChar"}run(e,t,n){const r=null==n?1:n;if(this.emacsController.inRectMarkMode)this.emacsController.moveRectActives((e=>e.translate(0,r)));else{if(1===r)return a.commands.executeCommand(t?"cursorRightSelect":"cursorRight");if(r>0){const n=e.document,i=e.selections.map((e=>{const i=n.offsetAt(e.active),s=n.positionAt(i+r),o=t?e.anchor:s;return new a.Selection(o,s)}));e.selections=i,(0,h.revealPrimaryActive)(e)}}}}t.ForwardChar=m;class g extends c.EmacsCommand{constructor(){super(...arguments),this.id="backwardChar"}run(e,t,n){const r=null==n?1:n;if(this.emacsController.inRectMarkMode)this.emacsController.moveRectActives((e=>new a.Position(e.line,Math.max(e.character-r,0))));else{if(1===r)return a.commands.executeCommand(t?"cursorLeftSelect":"cursorLeft");if(r>0){const n=e.document,i=e.selections.map((e=>{const i=n.offsetAt(e.active),s=n.positionAt(i-r),o=t?e.anchor:s;return new a.Selection(o,s)}));e.selections=i,(0,h.revealPrimaryActive)(e)}}}}t.BackwardChar=g;class p extends c.EmacsCommand{constructor(){super(...arguments),this.id="nextLine"}run(e,t,n){const r=null==n?1:n;if(!this.emacsController.inRectMarkMode)return a.commands.executeCommand("cursorMove",{to:"down",by:l.Configuration.instance.lineMoveVisual?"wrappedLine":"line",value:r,select:t});{const t=e.document.lineCount-1;this.emacsController.moveRectActives((e=>new a.Position(Math.min(e.line+r,t),e.character)))}}}t.NextLine=p;class f extends c.EmacsCommand{constructor(){super(...arguments),this.id="previousLine"}run(e,t,n){const r=null==n?1:n;if(!this.emacsController.inRectMarkMode)return a.commands.executeCommand("cursorMove",{to:"up",by:l.Configuration.instance.lineMoveVisual?"wrappedLine":"line",value:r,select:t});this.emacsController.moveRectActives((e=>new a.Position(Math.max(e.line-r,0),e.character)))}}t.PreviousLine=f;class v extends c.EmacsCommand{constructor(){super(...arguments),this.id="moveBeginningOfLine"}run(e,t,n){let r;this.emacsController.inRectMarkMode&&this.emacsController.moveRectActives((t=>e.document.lineAt(t.line).range.start)),r=l.Configuration.instance.strictEmacsMove?t?"cursorLineStartSelect":"cursorLineStart":t?"cursorHomeSelect":"cursorHome";const i=()=>a.commands.executeCommand(r);return void 0===n||1===n?i():n>1?a.commands.executeCommand("cursorMove",{to:"down",by:"line",value:n-1,isInMarkMode:t}).then(i):void 0}}t.MoveBeginningOfLine=v;class x extends c.EmacsCommand{constructor(){super(...arguments),this.id="moveEndOfLine"}run(e,t,n){if(this.emacsController.inRectMarkMode)return void this.emacsController.moveRectActives((t=>e.document.lineAt(t.line).range.end));let r;r=l.Configuration.instance.strictEmacsMove?t?"cursorLineEndSelect":"cursorLineEnd":t?"cursorEndSelect":"cursorEnd";const i=()=>a.commands.executeCommand(r);return void 0===n||1===n?i():n>1?a.commands.executeCommand("cursorMove",{to:"down",by:"line",value:n-1,isInMarkMode:t}).then(i):void 0}}t.MoveEndOfLine=x;class w extends c.EmacsCommand{constructor(){super(...arguments),this.id="forwardWord"}run(e,t,n){if(this.emacsController.inRectMarkMode)return;const r=void 0===n?1:n;return(0,c.makeParallel)(r,(()=>a.commands.executeCommand(t?"cursorWordRightSelect":"cursorWordRight")))}}t.ForwardWord=w;class y extends c.EmacsCommand{constructor(){super(...arguments),this.id="backwardWord"}run(e,t,n){if(this.emacsController.inRectMarkMode)return;const r=void 0===n?1:n;return(0,c.makeParallel)(r,(()=>a.commands.executeCommand(t?"cursorWordLeftSelect":"cursorWordLeft")))}}t.BackwardWord=y;class C extends c.EmacsCommand{constructor(){super(...arguments),this.id="backToIndentation"}run(e,t,n){const r=e.document,i=e=>{const t=r.lineAt(e.line),n=t.firstNonWhitespaceCharacterIndex;return new a.Position(t.lineNumber,n)};if(this.emacsController.inRectMarkMode)return void this.emacsController.moveRectActives(i);const s=e.selections.map((e=>{const n=i(e.active);return new a.Selection(t?e.anchor:n,n)}));e.selections=s,(0,h.revealPrimaryActive)(e)}}t.BackToIndentation=C;class M extends c.EmacsCommand{constructor(){super(...arguments),this.id="beginningOfBuffer"}run(e,t,n){if(!this.emacsController.inRectMarkMode)return t||(this.emacsController.pushMark(e.selections.map((e=>e.anchor))),d.MessageManager.showMessage("Mark set")),a.commands.executeCommand(t?"cursorTopSelect":"cursorTop");{const t=e.document.positionAt(0);this.emacsController.moveRectActives((()=>t))}}}t.BeginningOfBuffer=M;class b extends c.EmacsCommand{constructor(){super(...arguments),this.id="endOfBuffer"}run(e,t,n){if(!this.emacsController.inRectMarkMode)return t||(this.emacsController.pushMark(e.selections.map((e=>e.anchor))),d.MessageManager.showMessage("Mark set")),a.commands.executeCommand(t?"cursorBottomSelect":"cursorBottom");{const t=e.document.lineAt(e.document.lineCount-1).range.end;this.emacsController.moveRectActives((()=>t))}}}function R(e,t,n){const r=e.visibleRanges,i=r[0],s=r[r.length-1];if(null==i||null==s)return;const o=e.selection.anchor,c=e.selection.active;let l;if(c.isBefore(i.start))l=i.start.with(void 0,0);else{if(!(c.line>s.end.line+1))return;l=s.end.with(void 0,0)}if(n.inRectMarkMode)return void n.moveRectActives(((e,t)=>0===t?l:e));const u=[new a.Selection(t?o:l,l),...e.selections.slice(1)];e.selections=u}t.EndOfBuffer=b;class S extends c.EmacsCommand{constructor(){super(...arguments),this.id="scrollUpCommand"}run(e,t,n){return null!=n?a.commands.executeCommand("editorScroll",{to:"down",by:l.Configuration.instance.lineMoveVisual?"wrappedLine":"line",value:n}).then((()=>R(e,t,this.emacsController))):l.Configuration.instance.strictEmacsMove?a.commands.executeCommand("editorScroll",{to:"down",by:"page"}):a.commands.executeCommand(t?"cursorPageDownSelect":"cursorPageDown")}}t.ScrollUpCommand=S;class k extends c.EmacsCommand{constructor(){super(...arguments),this.id="scrollDownCommand"}run(e,t,n){return null!=n?a.commands.executeCommand("editorScroll",{to:"up",by:l.Configuration.instance.lineMoveVisual?"wrappedLine":"line",value:n}).then((()=>R(e,t,this.emacsController))):l.Configuration.instance.strictEmacsMove?a.commands.executeCommand("editorScroll",{to:"up",by:"page"}):a.commands.executeCommand(t?"cursorPageUpSelect":"cursorPageUp")}}t.ScrollDownCommand=k;class A extends c.EmacsCommand{constructor(){super(...arguments),this.id="forwardParagraph"}run(e,t,n){const r=void 0===n?1:n,i=e.document,s=e=>{for(let t=0;t<r;++t)e=(0,u.travelForward)(i,e);return e};if(this.emacsController.inRectMarkMode)return void this.emacsController.moveRectActives(s);const o=e.selections.map((e=>{const n=s(e.active);return new a.Selection(t?e.anchor:n,n)}));e.selections=o,(0,h.revealPrimaryActive)(e)}}t.ForwardParagraph=A;class P extends c.EmacsCommand{constructor(){super(...arguments),this.id="backwardParagraph"}run(e,t,n){const r=void 0===n?1:n,i=e.document,s=e=>{for(let t=0;t<r;++t)e=(0,u.travelBackward)(i,e);return e};if(this.emacsController.inRectMarkMode)return void this.emacsController.moveRectActives(s);const o=e.selections.map((e=>{const n=s(e.active);return new a.Selection(t?e.anchor:n,n)}));e.selections=o,(0,h.revealPrimaryActive)(e)}}t.BackwardParagraph=P},84:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),o=0;o<n.length;o++)"default"!==n[o]&&i(t,e,n[o]);return s(t,e),t}),a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.PareditKill=t.BackwardKillSexp=t.KillSexp=t.MarkSexp=t.BackwardUpSexp=t.ForwardDownSexp=t.BackwardSexp=t.ForwardSexp=void 0;const c=o(n(345)),l=n(398),u=n(59),d=n(291),h=n(653),m=n(40),g=new Set(["clojure","lisp","scheme"]),p=(e,t)=>{let n=e.getText();g.has(e.languageId)||(n=n.split(";").join("_"));const r=c.parse(n);return(n,i)=>{if(i<0)throw new Error(`Invalid repetition ${i}`);let s=e.offsetAt(n);for(let e=0;e<i;++e)s=t(r,s);return e.positionAt(s)}};class f extends u.EmacsCommand{run(e,t,n){return a(this,void 0,void 0,(function*(){const r=void 0===n?1:n;if(r<=0)return;const i=e.document,s=p(i,this.pareditNavigatorFn),o=e.selections.map((e=>{const n=s(e.active,r);return new l.Selection(t?e.anchor:n,n)}));e.selections=o,(0,m.revealPrimaryActive)(e)}))}}t.ForwardSexp=class extends f{constructor(){super(...arguments),this.id="paredit.forwardSexp",this.pareditNavigatorFn=c.navigator.forwardSexp}},t.BackwardSexp=class extends f{constructor(){super(...arguments),this.id="paredit.backwardSexp",this.pareditNavigatorFn=c.navigator.backwardSexp}},t.ForwardDownSexp=class extends f{constructor(){super(...arguments),this.id="paredit.forwardDownSexp",this.pareditNavigatorFn=c.navigator.forwardDownSexp}},t.BackwardUpSexp=class extends f{constructor(){super(...arguments),this.id="paredit.backwardUpSexp",this.pareditNavigatorFn=c.navigator.backwardUpSexp}};class v extends u.EmacsCommand{constructor(){super(...arguments),this.id="paredit.markSexp",this.continuing=!1}run(e,t,n){return a(this,void 0,void 0,(function*(){const t=void 0===n?1:n,r=Math.abs(t),i=t>0?c.navigator.forwardSexp:c.navigator.backwardSexp,s=e.document,o=p(s,i),a=e.selections.map((e=>{const t=o(e.active,r);return new l.Selection(e.anchor,t)}));e.selections=a,a.some((e=>!e.isEmpty))&&this.emacsController.enterMarkMode(!1),this.emacsController.pushMark(a.map((e=>e.active)),this.continuing),(0,m.revealPrimaryActive)(e),this.continuing=!0}))}onDidInterruptTextEditor(){this.continuing=!1}}t.MarkSexp=v;class x extends d.KillYankCommand{constructor(){super(...arguments),this.id="paredit.killSexp"}run(e,t,n){return a(this,void 0,void 0,(function*(){const t=void 0===n?1:n;if(t<=0)return;const r=e.document,i=p(r,c.navigator.forwardSexp),s=e.selections.map((e=>{const n=i(e.active,t);return new l.Range(e.anchor,n)}));yield this.killYanker.kill(s,!1),(0,m.revealPrimaryActive)(e)}))}}t.KillSexp=x;class w extends d.KillYankCommand{constructor(){super(...arguments),this.id="paredit.backwardKillSexp"}run(e,t,n){return a(this,void 0,void 0,(function*(){const t=void 0===n?1:n;if(t<=0)return;const r=e.document,i=p(r,c.navigator.backwardSexp),s=e.selections.map((e=>{const n=i(e.active,t);return new l.Range(e.anchor,n)}));yield this.killYanker.kill(s,!1,h.AppendDirection.Backward),(0,m.revealPrimaryActive)(e)}))}}t.BackwardKillSexp=w;class y extends d.KillYankCommand{constructor(){super(...arguments),this.id="paredit.pareditKill"}run(e,t,n){return a(this,void 0,void 0,(function*(){const t=void 0===n?1:n;if(t<=0)return;const r=e.document,i=r.getText(),s=e.selections.map((n=>{const s=p(r,((t,s)=>{for(;" "==i[s]||"\t"==i[s];)s+=1;const o=n.active.line,a=e.document.lineAt(o),c=r.offsetAt(a.range.end);if(s>=c){const t=e.document.lineAt(o+1);return r.offsetAt(t.range.start)}{let e,n=s;do{e=n,n=this.indexAfterKillSexp(t,e)}while(e<n&&n<c);return n}}))(n.active,t);return new l.Range(n.anchor,s)}));yield this.killYanker.kill(s.filter((e=>!e.isEmpty)),!1),(0,m.revealPrimaryActive)(e)}))}indexAfterKillSexp(e,t){const n=c.editor.killSexp(e,"",t,{count:1});if(null===n)return t;if(void 0!==n.changes[0]){const[e,r,i]=n.changes[0];if("remove"==e&&r==t&&n.newIndex==t&&"number"==typeof i)return r+i;throw new Error("Expected paredit.editor.killSexp to return a single deletion starting at the current cursor position and leaving the cursor at the same position")}throw new Error("Expected paredit.editor.killSexp to return a single change")}}t.PareditKill=y},503:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),o=0;o<n.length;o++)"default"!==n[o]&&i(t,e,n[o]);return s(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.RecenterTopBottom=void 0;const a=o(n(398)),c=n(398),l=n(59);var u;!function(e){e[e.Middle=0]="Middle",e[e.Top=1]="Top",e[e.Bottom=2]="Bottom"}(u||(u={}));class d extends l.EmacsCommand{constructor(){super(...arguments),this.id="recenterTopBottom",this.recenterPosition=u.Middle}run(e,t,n){const r=new a.Range(e.selection.active,e.selection.active);switch(this.recenterPosition){case u.Middle:e.revealRange(r,c.TextEditorRevealType.InCenter),this.recenterPosition=u.Top;break;case u.Top:e.revealRange(r,c.TextEditorRevealType.AtTop),this.recenterPosition=u.Bottom;break;case u.Bottom:{const t=e.visibleRanges[0];if(null==t)return;const n=t.start.line,r=t.end.line-n,i=e.selection.active.line,s=Math.max(i-r,1),o=new a.Position(s,0),c=new a.Range(o,o);e.revealRange(c),this.recenterPosition=u.Middle;break}}}onDidInterruptTextEditor(){this.recenterPosition=u.Middle}}t.RecenterTopBottom=d},54:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),o=0;o<n.length;o++)"default"!==n[o]&&i(t,e,n[o]);return s(t,e),t}),a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ReplaceKillRingToRectangle=t.StringRectangle=t.ClearRectangle=t.OpenRectangle=t.YankRectangle=t.KillRectangle=t.CopyRectangleAsKill=t.DeleteRectangle=t.RectangleKillYankCommand=t.StartAcceptingRectCommand=void 0;const c=o(n(398)),l=n(59),u=n(11),d=n(253);class h extends l.EmacsCommand{constructor(){super(...arguments),this.id="startAcceptingRectCommand",this.isIntermediateCommand=!0,this.acceptingRectCommand=!1}startAcceptingRectCommand(){this.acceptingRectCommand=!0,c.commands.executeCommand("setContext","emacs-mcx.acceptingRectCommand",!0)}stopAcceptingRectCommand(){this.acceptingRectCommand=!1,c.commands.executeCommand("setContext","emacs-mcx.acceptingRectCommand",!1)}run(){this.startAcceptingRectCommand()}onDidInterruptTextEditor(){this.acceptingRectCommand&&this.stopAcceptingRectCommand()}}t.StartAcceptingRectCommand=h;class m extends l.EmacsCommand{constructor(e,t){super(e),this.rectangleState=t}}t.RectangleKillYankCommand=m,t.DeleteRectangle=class extends m{constructor(){super(...arguments),this.id="deleteRectangle"}run(e,t,n){return a(this,void 0,void 0,(function*(){yield(0,d.copyOrDeleteRect)(this.emacsController,e,{copy:!1,delete:!0})}))}},t.CopyRectangleAsKill=class extends m{constructor(){super(...arguments),this.id="copyRectangleAsKill"}run(e,t,n){return a(this,void 0,void 0,(function*(){const t=yield(0,d.copyOrDeleteRect)(this.emacsController,e,{copy:!0,delete:!1});null!==t&&(this.rectangleState.latestKilledRectangle=t)}))}},t.KillRectangle=class extends m{constructor(){super(...arguments),this.id="killRectangle"}run(e,t,n){return a(this,void 0,void 0,(function*(){const t=yield(0,d.copyOrDeleteRect)(this.emacsController,e,{copy:!0,delete:!0});null!==t&&(this.rectangleState.latestKilledRectangle=t)}))}},t.YankRectangle=class extends m{constructor(){super(...arguments),this.id="yankRectangle"}run(e,t,n){return a(this,void 0,void 0,(function*(){const t=this.rectangleState.latestKilledRectangle;return(0,d.insertRect)(e,t)}))}};class g extends l.EmacsCommand{constructor(){super(...arguments),this.id="openRectangle"}run(e,t,n){return a(this,void 0,void 0,(function*(){const t=(0,u.getNonEmptySelections)(e);if(0===t.length)return;const n=e.selections.map((e=>e.start)),r=t.map(d.convertSelectionToRectSelections.bind(null,e.document)).reduce(((e,t)=>e.concat(t)),[]);yield e.edit((e=>{r.forEach((t=>{const n=t.end.character-t.start.character;e.insert(t.start," ".repeat(n))}))})),this.emacsController.exitMarkMode(),e.selections=n.map((e=>new c.Selection(e,e)))}))}}t.OpenRectangle=g;class p extends l.EmacsCommand{constructor(){super(...arguments),this.id="clearRectangle"}run(e,t,n){return a(this,void 0,void 0,(function*(){const t=(0,u.getNonEmptySelections)(e);if(0===t.length)return;const n=t.map(d.convertSelectionToRectSelections.bind(null,e.document)).reduce(((e,t)=>e.concat(t)),[]);yield e.edit((e=>{n.forEach((t=>{const n=t.end.character-t.start.character;e.replace(t," ".repeat(n))}))})),this.emacsController.exitMarkMode(),(0,u.makeSelectionsEmpty)(e)}))}}t.ClearRectangle=p;class f extends l.EmacsCommand{constructor(e,t){super(e),this.id="stringRectangle",this.minibuffer=t}run(e,t,n){return a(this,void 0,void 0,(function*(){const t=yield this.minibuffer.readFromMinibuffer({prompt:"String rectangle"});if(null==t)return;const n=(0,u.getNonEmptySelections)(e);if(0===n.length)return;const r=n.map(d.convertSelectionToRectSelections.bind(null,e.document)).reduce(((e,t)=>e.concat(t)),[]);yield e.edit((e=>{r.forEach((n=>{e.replace(n,t)}))})),this.emacsController.exitMarkMode(),(0,u.makeSelectionsEmpty)(e)}))}}t.StringRectangle=f;class v extends l.EmacsCommand{constructor(e,t){super(e),this.id="replaceKillRingToRectangle",this.killring=t}run(e,t,n){return a(this,void 0,void 0,(function*(){if(null===this.killring)return;const t=this.killring.getTop();if(null==t)return;const n=t.asString();if(""===n||-1!==n.indexOf("\n"))return;const r=(0,u.getNonEmptySelections)(e);if(1!==r.length)return;const i=r[0],s=Math.min(i.start.character,i.end.character),o=i.active.line;let a=s;i.active.character>=i.anchor.character&&(a=s+n.length);const l=(0,d.convertSelectionToRectSelections)(e.document,i);i.active.line<i.anchor.line&&l.reverse();const h=Math.max(i.start.line,0),m=Math.min(i.end.line,e.document.lineCount-1);yield e.edit((e=>{for(let t=h;t<=m;t++){const r=l[t-h];if(r.end.character<s){const i=s-r.end.character;e.insert(new c.Position(t,r.end.character)," ".repeat(i)+n)}else e.replace(r,n)}})),this.emacsController.exitMarkMode();const g=new c.Position(o,a);e.selections=[new c.Selection(g,g)]}))}}t.ReplaceKillRingToRectangle=v},669:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),o=0;o<n.length;o++)"default"!==n[o]&&i(t,e,n[o]);return s(t,e),t}),a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.RegisterNameCommand=t.JumpToRegister=t.PointToRegister=t.CopyRectangleToRegister=t.InsertRegister=t.CopyToRegister=t.RegisterCommandState=void 0;const c=o(n(398)),l=n(247),u=n(59),d=n(11),h=n(253),m=n(185),g=n(40);t.RegisterCommandState=class{constructor(){this._acceptingRegisterName=null}get acceptingRegisterName(){return this._acceptingRegisterName}startAcceptingRegisterName(e,t){this._acceptingRegisterName=e,c.commands.executeCommand("setContext","emacs-mcx.acceptingRectCommand",!1),c.commands.executeCommand("setContext","emacs-mcx.acceptingRegisterName",!0),l.MessageManager.showMessage(t)}stopAcceptingRegisterName(){this._acceptingRegisterName&&(this._acceptingRegisterName=null,c.commands.executeCommand("setContext","emacs-mcx.acceptingRegisterName",!1),l.MessageManager.removeMessage())}};class p extends u.EmacsCommand{constructor(e,t){super(e),this.registerCommandState=t,this.id="copyToRegister",this.isIntermediateCommand=!0}run(){this.registerCommandState.startAcceptingRegisterName("copy","Copy to register: ")}onDidInterruptTextEditor(){this.registerCommandState.stopAcceptingRegisterName()}}t.CopyToRegister=p;class f extends u.EmacsCommand{constructor(e,t){super(e),this.registerCommandState=t,this.id="insertRegister",this.isIntermediateCommand=!0}run(){this.registerCommandState.startAcceptingRegisterName("insert","Insert from register: ")}onDidInterruptTextEditor(){this.registerCommandState.stopAcceptingRegisterName()}}t.InsertRegister=f;class v extends u.EmacsCommand{constructor(e,t){super(e),this.registerCommandState=t,this.id="copyRectangleToRegister",this.isIntermediateCommand=!0}run(){this.registerCommandState.startAcceptingRegisterName("copy-rectangle","Copy rectangle to register: ")}onDidInterruptTextEditor(){this.registerCommandState.stopAcceptingRegisterName()}}t.CopyRectangleToRegister=v;class x extends u.EmacsCommand{constructor(e,t){super(e),this.registerCommandState=t,this.id="pointToRegister",this.isIntermediateCommand=!0}run(){this.registerCommandState.startAcceptingRegisterName("point","Point to register: ")}onDidInterruptTextEditor(){this.registerCommandState.stopAcceptingRegisterName()}}t.PointToRegister=x;class w extends u.EmacsCommand{constructor(e,t){super(e),this.registerCommandState=t,this.id="jumpToRegister",this.isIntermediateCommand=!0}run(){this.registerCommandState.startAcceptingRegisterName("jump","Jump to register: ")}onDidInterruptTextEditor(){this.registerCommandState.stopAcceptingRegisterName()}}t.JumpToRegister=w;class y extends u.EmacsCommand{constructor(e,t,n){super(e),this.registers=t,this.registerCommandState=n,this.id="registerNameCommand"}run(e,t,n,r){const i=this.registerCommandState.acceptingRegisterName;if(!i)return;this.registerCommandState.stopAcceptingRegisterName();const s=null==r?void 0:r[0];if("string"!=typeof s||1!==s.length)return;const o=null!=n;return"copy"===i?this.runCopy(e,s,o):"insert"===i?this.runInsert(e,s):"copy-rectangle"===i?this.runCopyRectangle(e,s,o):"point"===i?this.runPoint(e,s):"jump"===i?this.runJump(e,s):void 0}runCopy(e,t,n){return a(this,void 0,void 0,(function*(){const r=this.emacsController.inRectMarkMode&&this.emacsController.nativeSelections.map((e=>{const t=e.active.line,n=Math.min(e.active.character,e.anchor.character);return new c.Selection(t,n,t,n)})),i=(0,d.getNonEmptySelections)(e);r&&(e.selections=r);const s=i.map((t=>e.document.getText(t))).join("");n&&(yield(0,m.deleteRanges)(e,i),(0,g.revealPrimaryActive)(e)),this.registers.set(t,{type:"text",text:s}),this.emacsController.exitMarkMode(),(0,d.makeSelectionsEmpty)(e)}))}runInsert(e,t){return a(this,void 0,void 0,(function*(){const n=e.selections;this.emacsController.pushMark(n.map((e=>e.active)));const r=this.registers.get(t);null!=r?("text"===r.type?yield e.edit((e=>{n.forEach((t=>{t.isEmpty||e.delete(t),e.insert(t.start,r.text)}))})):"rectangle"===r.type&&(yield(0,h.insertRect)(e,r.rectTexts)),l.MessageManager.showMessage("Mark set")):l.MessageManager.showMessage("Register does not contain text")}))}runCopyRectangle(e,t,n){return a(this,void 0,void 0,(function*(){const r=yield(0,h.copyOrDeleteRect)(this.emacsController,e,{copy:!0,delete:n});r&&this.registers.set(t,{type:"rectangle",rectTexts:r}),this.emacsController.exitMarkMode(),(0,d.makeSelectionsEmpty)(e)}))}runPoint(e,t){return a(this,void 0,void 0,(function*(){const n=e.selections.map((e=>e.active));this.registers.set(t,{type:"position",buffer:e.document.uri,positions:n})}))}runJump(e,t){return a(this,void 0,void 0,(function*(){const e=this.registers.get(t);if(null==e||"position"!==e.type)return void l.MessageManager.showMessage("Register doesn't contain a buffer position or configuration");const n=c.workspace.textDocuments.find((t=>t.uri.toString()===e.buffer.toString()));if(!n)return void l.MessageManager.showMessage("That register's buffer no longer exists");const r=e.positions.map((e=>new c.Selection(e,e)));yield c.window.showTextDocument(n,{selection:r[0]}),c.window.activeTextEditor&&(c.window.activeTextEditor.selections=r)}))}}t.RegisterNameCommand=y},196:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmacsCommandRegistry=void 0;const r=n(59);t.EmacsCommandRegistry=class{constructor(){this.commands=new Map,this.interruptionHandlers=[]}register(e){this.commands.set(e.id,e),(0,r.isTextEditorInterruptionHandler)(e)&&this.interruptionHandlers.push(e)}get(e){return this.commands.get(e)}onInterrupt(){for(const e of this.interruptionHandlers)e.onDidInterruptTextEditor()}}},436:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),o=0;o<n.length;o++)"default"!==n[o]&&i(t,e,n[o]);return s(t,e),t}),a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.TabToTabStop=void 0;const c=o(n(398)),l=n(398),u=n(59),d=["python"];class h extends u.EmacsCommand{constructor(){super(...arguments),this.id="tabToTabStop",this.latestSelections=[],this.latestIndentLevels=[]}run(e,t,n){return a(this,void 0,void 0,(function*(){return d.includes(e.document.languageId)?this.runInOffsideRuleLanguage(e):(0,u.makeParallel)(e.selections.length,(()=>c.commands.executeCommand("editor.action.reindentselectedlines"))).then((()=>{e.selections=e.selections.map((t=>{const n=e.document.lineAt(t.active.line).firstNonWhitespaceCharacterIndex;if(t.active.character>n)return new l.Selection(t.active,t.active);const r=new c.Position(t.active.line,n);return new l.Selection(r,r)})),this.emacsController.exitMarkMode()}))}))}runInOffsideRuleLanguage(e){return a(this,void 0,void 0,(function*(){const t=e.options.tabSize,n=e.options.insertSpaces,r=n?t:1,i=e.selections.map(((n,i)=>{let s;for(let t=n.active.line-1;t>=0;t--){const n=e.document.lineAt(t);if(!n.isEmptyOrWhitespace){s=n;break}}const o=null==s?void 0:s.firstNonWhitespaceCharacterIndex,a=null!=o?Math.floor(o/t)+1:0,c=this.latestIndentLevels[i],l=null!=c&&0<c&&c<=a?c-1:a,u=l*r,d=e.document.lineAt(n.active.line),h=Math.max(n.active.character-d.firstNonWhitespaceCharacterIndex,0);return{line:n.active.line,newIndentLevel:l,newIndentChars:u,newCursorChars:u+h}})),s=n?" ":"\t";yield e.edit((t=>{i.forEach((n=>{const r=e.document.lineAt(n.line),i=r.range.start,o=n.newIndentChars-r.firstNonWhitespaceCharacterIndex;o>=0?t.insert(i,s.repeat(o)):t.delete(new c.Range(i,new c.Position(n.line,-o)))}))})),e.selections=i.map((e=>{const t=new c.Position(e.line,e.newCursorChars);return new c.Selection(t,t)})),this.latestIndentLevels=i.map((e=>e.newIndentLevel)),this.latestTextEditor=e,this.latestSelections=e.selections,this.emacsController.exitMarkMode()}))}onDidInterruptTextEditor(){this.latestTextEditor===c.window.activeTextEditor&&this.latestSelections.every(((e,t)=>{var n;const r=null===(n=c.window.activeTextEditor)||void 0===n?void 0:n.selections[t];return r&&e.isEqual(r)}))||(this.latestIndentLevels=[])}}t.TabToTabStop=h},915:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),o=0;o<n.length;o++)"default"!==n[o]&&i(t,e,n[o]);return s(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.Configuration=void 0;const a=n(614),c=o(n(398)),l=o(n(345));class u{static get instance(){return this.inst||(this.inst=new u),this.inst}static registerDispose(e){e.subscriptions.push(this.instance)}static reload(){this.instance.reload()}constructor(){this.killRingMax=60,this.markRingMax=16,this.strictEmacsMove=!1,this.killWholeLine=!1,this.enableOverridingTypeCommand=!1,this.lineMoveVisual=!0,this.paredit={parentheses:{"[":"]","(":")","{":"}"}},this.debug={silent:!1,loggingLevelForAlert:"error",loggingLevelForConsole:"error"},this.reload()}dispose(){}reload(){const e=c.workspace.getConfiguration("emacs-mcx");for(const t in this){let n=e[t];null!=n&&(n.constructor.name===Object.name&&(n=u.unproxify(n)),this[t]=n)}a.Logger.configChanged(this),l.reader.setParentheses(this.paredit.parentheses)}static unproxify(e){const t={};for(const n in e){const r=e[n];null!=r&&(t[n]=r)}return t}}t.Configuration=u},290:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmacsEmulatorMap=void 0;const r=n(597);t.EmacsEmulatorMap=class{constructor(e,t,n){this.emacsEmulatorMap=new Map,this.killRing=e,this.minibuffer=t,this.registers=n}getOrCreate(e){const t=e.document.uri.toString();let n=!1,i=this.get(t);return i?i.setTextEditor(e):(n=!0,i=new r.EmacsEmulator(e,this.killRing,this.minibuffer,this.registers),this.emacsEmulatorMap.set(t,i)),[i,n]}get(e){return this.emacsEmulatorMap.get(e)}keys(){return this.emacsEmulatorMap.keys()}delete(e){const t=this.emacsEmulatorMap.get(e);t&&t.dispose(),this.emacsEmulatorMap.delete(e)}}},597:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),o=0;o<n.length;o++)"default"!==n[o]&&i(t,e,n[o]);return s(t,e),t}),a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.EmacsEmulator=void 0;const c=o(n(398)),l=n(398),u=n(189),d=o(n(763)),h=n(237),m=o(n(691)),g=o(n(436)),p=o(n(618)),f=o(n(880)),v=o(n(291)),x=o(n(202)),w=o(n(84)),y=o(n(54)),C=o(n(669)),M=n(503),b=n(196),R=n(653),S=n(614),k=n(247),A=n(623),P=n(915),_=n(506),E=n(253),O=n(387),T=n(861),j=n(185);class I{constructor(){this._nativeSelectionsMap=new WeakMap,this._nativeSelectionsSetPromiseMap=new WeakMap}get(e){const t=this._nativeSelectionsMap.get(e);if(t)return t;const n=e.selections;return this.set(e,n),n}set(e,t){this._nativeSelectionsMap.set(e,t);const n=this._nativeSelectionsSetPromiseMap.get(e);n&&(n.resolvePromise(),this._nativeSelectionsSetPromiseMap.delete(e))}waitSet(e,t){const n=new T.PromiseDelegate;return this._nativeSelectionsSetPromiseMap.set(e,n),Promise.any([n.promise,(0,j.delay)(t)])}}t.EmacsEmulator=class{get textEditor(){return this._textEditor}get isInMarkMode(){return this._isInMarkMode}get markModeAnchors(){return this._markModeAnchors}get inRectMarkMode(){return this._isInMarkMode&&this.rectMode}get nativeSelections(){return this.nativeSelectionsStore.get(this.textEditor)}applyNativeSelectionsAsRect(){if(this.inRectMarkMode){const e=this.nativeSelections.flatMap(E.convertSelectionToRectSelections.bind(null,this.textEditor.document));this.textEditor.selections=e}}moveRectActives(e){const t=this.nativeSelections.map(((t,n)=>{const r=e(t.active,n);return new c.Selection(t.anchor,r)}));this.nativeSelectionsStore.set(this.textEditor,t),this.applyNativeSelectionsAsRect()}constructor(e,t=null,n=new O.InputBoxMinibuffer,r=new Map){this._isInMarkMode=!1,this._markModeAnchors=[],this.rectMode=!1,this.nativeSelectionsStore=new I,this.normalCursorStyle=void 0,this._textEditor=e,this.markRing=new _.MarkRing(P.Configuration.instance.markRingMax),this.prevExchangedMarks=null,this.prefixArgumentHandler=new A.PrefixArgumentHandler(this.onPrefixArgumentChange,this.onPrefixArgumentAcceptingStateChange),this.disposables=[],c.workspace.onDidChangeTextDocument(this.onDidChangeTextDocument,this,this.disposables),c.window.onDidChangeTextEditorSelection(this.onDidChangeTextEditorSelection,this,this.disposables),this.commandRegistry=new b.EmacsCommandRegistry,this.afterCommand=this.afterCommand.bind(this),this.commandRegistry.register(new x.ForwardChar(this)),this.commandRegistry.register(new x.BackwardChar(this)),this.commandRegistry.register(new x.NextLine(this)),this.commandRegistry.register(new x.PreviousLine(this)),this.commandRegistry.register(new x.MoveBeginningOfLine(this)),this.commandRegistry.register(new x.MoveEndOfLine(this)),this.commandRegistry.register(new x.ForwardWord(this)),this.commandRegistry.register(new x.BackwardWord(this)),this.commandRegistry.register(new x.BackToIndentation(this)),this.commandRegistry.register(new x.BeginningOfBuffer(this)),this.commandRegistry.register(new x.EndOfBuffer(this)),this.commandRegistry.register(new x.ScrollUpCommand(this)),this.commandRegistry.register(new x.ScrollDownCommand(this)),c.window.onDidChangeTextEditorVisibleRanges((()=>{P.Configuration.instance.strictEmacsMove&&x.movePrimaryCursorIntoVisibleRange(this.textEditor,this.isInMarkMode,this)}),this,this.disposables),this.commandRegistry.register(new x.ForwardParagraph(this)),this.commandRegistry.register(new x.BackwardParagraph(this)),this.commandRegistry.register(new m.DeleteBackwardChar(this)),this.commandRegistry.register(new m.DeleteForwardChar(this)),this.commandRegistry.register(new m.DeleteHorizontalSpace(this)),this.commandRegistry.register(new m.NewLine(this)),this.commandRegistry.register(new h.DeleteBlankLines(this)),this.commandRegistry.register(new M.RecenterTopBottom(this)),this.commandRegistry.register(new g.TabToTabStop(this)),this.commandRegistry.register(new p.DeleteIndentation(this));const i={startSelections:void 0};this.commandRegistry.register(new f.IsearchForward(this,i)),this.commandRegistry.register(new f.IsearchBackward(this,i)),this.commandRegistry.register(new f.IsearchForwardRegexp(this,i)),this.commandRegistry.register(new f.IsearchBackwardRegexp(this,i)),this.commandRegistry.register(new f.QueryReplace(this,i)),this.commandRegistry.register(new f.QueryReplaceRegexp(this,i)),this.commandRegistry.register(new f.IsearchAbort(this,i)),this.commandRegistry.register(new f.IsearchExit(this,i));const s=new R.KillYanker(this,t,n);this.commandRegistry.register(new v.KillWord(this,s)),this.commandRegistry.register(new v.BackwardKillWord(this,s)),this.commandRegistry.register(new v.KillLine(this,s)),this.commandRegistry.register(new v.KillWholeLine(this,s)),this.commandRegistry.register(new v.KillRegion(this,s)),this.commandRegistry.register(new v.CopyRegion(this,s)),this.commandRegistry.register(new v.Yank(this,s)),this.commandRegistry.register(new v.YankPop(this,s)),this.killYanker=s,this.registerDisposable(s);const o=new C.RegisterCommandState;this.commandRegistry.register(new C.CopyToRegister(this,o)),this.commandRegistry.register(new C.InsertRegister(this,o)),this.commandRegistry.register(new C.CopyRectangleToRegister(this,o)),this.commandRegistry.register(new C.PointToRegister(this,o)),this.commandRegistry.register(new C.JumpToRegister(this,o)),this.commandRegistry.register(new C.RegisterNameCommand(this,r,o));const a={latestKilledRectangle:[]};this.commandRegistry.register(new y.StartAcceptingRectCommand(this)),this.commandRegistry.register(new y.KillRectangle(this,a)),this.commandRegistry.register(new y.CopyRectangleAsKill(this,a)),this.commandRegistry.register(new y.DeleteRectangle(this,a)),this.commandRegistry.register(new y.YankRectangle(this,a)),this.commandRegistry.register(new y.OpenRectangle(this)),this.commandRegistry.register(new y.ClearRectangle(this)),this.commandRegistry.register(new y.StringRectangle(this,n)),this.commandRegistry.register(new y.ReplaceKillRingToRectangle(this,t)),this.commandRegistry.register(new w.ForwardSexp(this)),this.commandRegistry.register(new w.BackwardSexp(this)),this.commandRegistry.register(new w.ForwardDownSexp(this)),this.commandRegistry.register(new w.BackwardUpSexp(this)),this.commandRegistry.register(new w.MarkSexp(this)),this.commandRegistry.register(new w.KillSexp(this,s)),this.commandRegistry.register(new w.BackwardKillSexp(this,s)),this.commandRegistry.register(new w.PareditKill(this,s)),this.commandRegistry.register(new u.AddSelectionToNextFindMatch(this)),this.commandRegistry.register(new u.AddSelectionToPreviousFindMatch(this)),this.commandRegistry.register(new d.TransformToUppercase(this)),this.commandRegistry.register(new d.TransformToLowercase(this)),this.commandRegistry.register(new d.TransformToTitlecase(this))}setTextEditor(e){this._textEditor=e}switchTextEditor(e){return a(this,void 0,void 0,(function*(){this.setTextEditor(e),yield this.nativeSelectionsStore.waitSet(e,100),this.nativeSelectionsStore.set(e,this.isInMarkMode?this.nativeSelections.map(((e,t)=>{var n;const r=null!==(n=this.markModeAnchors[t])&&void 0!==n?n:e.anchor;return new c.Selection(r,e.active)})):this.nativeSelections.map((e=>new c.Selection(e.active,e.active)))),this.rectMode?this.applyNativeSelectionsAsRect():this.textEditor.selections=this.nativeSelections,this.rectMode||(e.options.cursorStyle=this.normalCursorStyle)}))}getTextEditor(){return this.textEditor}registerDisposable(e){this.disposables.push(e)}dispose(){for(const e of this.disposables)e.dispose()}onDidChangeTextDocument(e){e.document.uri.toString()===this.textEditor.document.uri.toString()&&(e.contentChanges.some((e=>this.textEditor.selections.some((t=>void 0!==e.range.intersection(t)))))&&this.exitMarkMode(),this.onDidInterruptTextEditor())}onDidChangeTextEditorSelection(e){this.rectMode||this.nativeSelectionsStore.set(e.textEditor,e.textEditor.selections),e.textEditor===this.textEditor&&this.onDidInterruptTextEditor()}typeChar(e){if(this.isInMarkMode&&this.exitMarkMode(),"-"===e&&this.prefixArgumentHandler.minusSignAcceptable)return this.prefixArgumentHandler.negativeArgument();const t=this.prefixArgumentHandler.getPrefixArgument();this.prefixArgumentHandler.cancel();const n=null==t?1:t;if(!(n<0))return 1==n?c.commands.executeCommand("type",{text:e}):this.textEditor.edit((t=>{this.textEditor.selections.forEach((r=>{t.insert(r.active,e.repeat(n))}))}));k.MessageManager.showMessage(`Negative repetition argument ${n}`)}type(e){const t=this.prefixArgumentHandler.getPrefixArgument();if(this.prefixArgumentHandler.cancel(),S.logger.debug(`[EmacsEmulator.type]\t Single char (text: "${e}", prefix argument: ${t}).`),void 0!==t&&t>=0){const n=[];for(let r=0;r<t;++r){const t=c.commands.executeCommand("default:type",{text:e});n.push(t)}return Promise.all(n)}return S.logger.debug(`[EmacsEmulator.type]\t Execute "default:type" (text: "${e}")`),c.commands.executeCommand("default:type",{text:e})}universalArgument(){return this.prefixArgumentHandler.universalArgument()}digitArgument(e){return this.prefixArgumentHandler.digitArgument(e)}negativeArgument(){return this.prefixArgumentHandler.negativeArgument()}subsequentArgumentDigit(e){return this.prefixArgumentHandler.subsequentArgumentDigit(e)}onPrefixArgumentChange(e){return S.logger.debug(`[EmacsEmulator.onPrefixArgumentChange]\t Prefix argument: ${e}`),Promise.all([c.commands.executeCommand("setContext","emacs-mcx.prefixArgument",e),c.commands.executeCommand("setContext","emacs-mcx.prefixArgumentExists",null!=e)])}onPrefixArgumentAcceptingStateChange(e){return S.logger.debug(`[EmacsEmulator.onPrefixArgumentAcceptingStateChange]\t Prefix accepting: ${e}`),c.commands.executeCommand("setContext","emacs-mcx.acceptingArgument",e)}runCommand(e,t){const n=this.commandRegistry.get(e);if(void 0===n)throw Error(`command ${e} is not found`);if(n.isIntermediateCommand)return n.run(this.textEditor,this.isInMarkMode,this.getPrefixArgument(),t);const r=this.prefixArgumentHandler.getPrefixArgument(),i=n.run(this.textEditor,this.isInMarkMode,r,t);return this.afterCommand(),i}setMarkCommand(){if(this.prefixArgumentHandler.precedingSingleCtrlU())return this.prefixArgumentHandler.cancel(),this.popMark();this.isInMarkMode&&!this.hasNonEmptySelection()?(this.exitMarkMode(),k.MessageManager.showMessage("Mark deactivated")):(this.enterMarkMode(),k.MessageManager.showMessage("Mark activated"))}rectangleMarkMode(){this.inRectMarkMode?this.exitRectangleMarkMode():this.enterRectangleMarkMode()}enterRectangleMarkMode(){this.isInMarkMode?k.MessageManager.showMessage("Rectangle-Mark mode enabled in current buffer"):k.MessageManager.showMessage("Mark set (rectangle-mode)"),this.enterMarkMode(),this.rectMode=!0,c.commands.executeCommand("setContext","emacs-mcx.inRectMarkMode",!0),this.applyNativeSelectionsAsRect(),this.normalCursorStyle=this.textEditor.options.cursorStyle,this.textEditor.options.cursorStyle=c.TextEditorCursorStyle.LineThin}exitRectangleMarkMode(){this.rectMode&&(this.rectMode=!1,c.commands.executeCommand("setContext","emacs-mcx.inRectMarkMode",!1),this.textEditor.selections=this.nativeSelections,this.isInMarkMode||this.makeSelectionsEmpty(),this.textEditor.options.cursorStyle=this.normalCursorStyle)}cancel(){this.rectMode&&this.exitRectangleMarkMode(),this.hasMultipleSelections()&&!this.hasNonEmptySelection()?this.stopMultiCursor():this.makeSelectionsEmpty(),this.isInMarkMode&&this.exitMarkMode(),this.onDidInterruptTextEditor(),this.killYanker.cancelKillAppend(),this.prefixArgumentHandler.cancel(),k.MessageManager.showMessage("Quit")}enterMarkMode(e=!0){this._isInMarkMode=!0,this._markModeAnchors=this.textEditor.selections.map((e=>e.anchor)),this.rectMode=!1,c.commands.executeCommand("setContext","emacs-mcx.inMarkMode",!0),e&&(this.pushMark(this.textEditor.selections.map((e=>e.active))),this.textEditor.selections=this.textEditor.selections.map((e=>new l.Selection(e.active,e.active))))}pushMark(e,t=!1){this.prevExchangedMarks=null,this.markRing.push(e,t)}popMark(){const e=this.markRing.pop();e&&(this.textEditor.selections=e.map((e=>new l.Selection(e,e))),this.textEditor.revealRange(this.textEditor.selection))}exchangePointAndMark(){const e=this.prevExchangedMarks||this.markRing.getTop();if(this.enterMarkMode(!1),this.prevExchangedMarks=this.textEditor.selections.map((e=>e.active)),e){const t=Math.min(this.textEditor.selections.length,e.length),n=this.textEditor.selections.slice(0,t).map(((t,n)=>{const r=e[n];return new c.Selection(t.active,r)})).concat(this.textEditor.selections.slice(t));this.textEditor.selections=n,this.textEditor.revealRange(this.textEditor.selection)}}exitMarkMode(){this._isInMarkMode=!1,this.exitRectangleMarkMode(),c.commands.executeCommand("setContext","emacs-mcx.inMarkMode",!1)}executeCommandWithPrefixArgument(e,t=void 0,n="prefixArgument"){const r=this.prefixArgumentHandler.getPrefixArgument();return this.prefixArgumentHandler.cancel(),c.commands.executeCommand(e,Object.assign(Object.assign({},t),{[n]:r}))}getPrefixArgument(){return this.prefixArgumentHandler.getPrefixArgument()}makeSelectionsEmpty(){const e=this.rectMode?this.nativeSelections:this.textEditor.selections;this.textEditor.selections=e.map((e=>new l.Selection(e.active,e.active)))}stopMultiCursor(){c.commands.executeCommand("removeSecondaryCursors")}hasMultipleSelections(){return this.textEditor.selections.length>1}hasNonEmptySelection(){return this.textEditor.selections.some((e=>!e.isEmpty))}afterCommand(){return this.prefixArgumentHandler.cancel()}onDidInterruptTextEditor(){this.commandRegistry.onInterrupt()}}},265:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),o=0;o<n.length;o++)"default"!==n[o]&&i(t,e,n[o]);return s(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.activate=function(e){g.MessageManager.registerDispose(e),l.Configuration.registerDispose(e),e.subscriptions.push(u.WorkspaceConfigCache.instance);const t=new h.KillRing(l.Configuration.instance.killRingMax),n=new p.InputBoxMinibuffer,r=new Map,i=new d.EmacsEmulatorMap(t,n,r);function s(t,n,r){const s=a.commands.registerCommand(t,((...s)=>{m.logger.debug(`[command]\t Command "${t}" executed with args (${JSON.stringify(s)})`);const o=function(){const t=a.window.activeTextEditor;if(void 0===t)return;const[n,r]=i.getOrCreate(t);return r&&e.subscriptions.push(n),n}();return o?n(o,...s):"function"==typeof r?r(...s):void 0}));e.subscriptions.push(s)}e.subscriptions.push(a.window.onDidChangeActiveTextEditor((t=>{if(null==t)return;const[n,r]=i.getOrCreate(t);r?e.subscriptions.push(n):n.switchTextEditor(t)}))),e.subscriptions.push(a.workspace.onDidCloseTextDocument((()=>{const e=a.workspace.textDocuments;for(const t of i.keys()){const n=i.get(t);null!=n&&e.includes(n.getTextEditor().document)||i.delete(t)}}))),e.subscriptions.push(a.workspace.onDidChangeConfiguration((e=>{e.affectsConfiguration("emacs-mcx")&&l.Configuration.reload()}))),l.Configuration.instance.enableOverridingTypeCommand&&s("type",((e,t)=>{const n=t.text;return m.logger.debug(`[type command]\t args.text = "${n}"`),e.type(n)}),(e=>a.commands.executeCommand("default:type",e))),s("emacs-mcx.subsequentArgumentDigit",((e,t)=>{if(!Array.isArray(t))return;const n=t[0];return"number"==typeof n?e.subsequentArgumentDigit(n):void 0})),s("emacs-mcx.digitArgument",((e,t)=>{if(!Array.isArray(t))return;const n=t[0];return"number"==typeof n?e.digitArgument(n):void 0})),s("emacs-mcx.typeChar",((e,t)=>{if(!Array.isArray(t))return;const n=t[0];return"string"==typeof n?e.typeChar(n):void 0})),c.moveCommandIds.map((e=>{s(`emacs-mcx.${e}`,(t=>t.runCommand(e)))})),s("emacs-mcx.isearchForward",(e=>e.runCommand("isearchForward"))),s("emacs-mcx.isearchBackward",(e=>e.runCommand("isearchBackward"))),s("emacs-mcx.isearchForwardRegexp",(e=>e.runCommand("isearchForwardRegexp"))),s("emacs-mcx.isearchBackwardRegexp",(e=>e.runCommand("isearchBackwardRegexp"))),s("emacs-mcx.queryReplace",(e=>e.runCommand("queryReplace"))),s("emacs-mcx.queryReplaceRegexp",(e=>e.runCommand("queryReplaceRegexp"))),s("emacs-mcx.isearchAbort",(e=>e.runCommand("isearchAbort"))),s("emacs-mcx.isearchExit",((e,...t)=>e.runCommand("isearchExit",t))),s("emacs-mcx.deleteBackwardChar",(e=>e.runCommand("deleteBackwardChar"))),s("emacs-mcx.deleteForwardChar",(e=>e.runCommand("deleteForwardChar"))),s("emacs-mcx.deleteHorizontalSpace",(e=>e.runCommand("deleteHorizontalSpace"))),s("emacs-mcx.universalArgument",(e=>e.universalArgument())),s("emacs-mcx.negativeArgument",(e=>e.negativeArgument())),s("emacs-mcx.killLine",(e=>e.runCommand("killLine"))),s("emacs-mcx.killWord",(e=>e.runCommand("killWord"))),s("emacs-mcx.backwardKillWord",(e=>e.runCommand("backwardKillWord"))),s("emacs-mcx.killWholeLine",(e=>e.runCommand("killWholeLine"))),s("emacs-mcx.killRegion",(e=>e.runCommand("killRegion"))),s("emacs-mcx.copyRegion",(e=>e.runCommand("copyRegion"))),s("emacs-mcx.yank",(e=>e.runCommand("yank"))),s("emacs-mcx.yank-pop",(e=>e.runCommand("yankPop"))),s("emacs-mcx.startRectCommand",(e=>e.runCommand("startAcceptingRectCommand"))),s("emacs-mcx.killRectangle",(e=>e.runCommand("killRectangle"))),s("emacs-mcx.copyRectangleAsKill",(e=>e.runCommand("copyRectangleAsKill"))),s("emacs-mcx.deleteRectangle",(e=>e.runCommand("deleteRectangle"))),s("emacs-mcx.yankRectangle",(e=>e.runCommand("yankRectangle"))),s("emacs-mcx.openRectangle",(e=>e.runCommand("openRectangle"))),s("emacs-mcx.clearRectangle",(e=>e.runCommand("clearRectangle"))),s("emacs-mcx.stringRectangle",(e=>e.runCommand("stringRectangle"))),s("emacs-mcx.replaceKillRingToRectangle",(e=>e.runCommand("replaceKillRingToRectangle"))),s("emacs-mcx.setMarkCommand",(e=>e.setMarkCommand())),s("emacs-mcx.rectangleMarkMode",(e=>e.rectangleMarkMode())),s("emacs-mcx.popMark",(e=>e.popMark())),s("emacs-mcx.exchangePointAndMark",(e=>e.exchangePointAndMark())),s("emacs-mcx.addSelectionToNextFindMatch",(e=>e.runCommand("addSelectionToNextFindMatch"))),s("emacs-mcx.addSelectionToPreviousFindMatch",(e=>e.runCommand("addSelectionToPreviousFindMatch"))),s("emacs-mcx.cancel",(e=>e.cancel())),s("emacs-mcx.newLine",(e=>e.runCommand("newLine"))),s("emacs-mcx.transformToUppercase",(e=>e.runCommand("transformToUppercase"))),s("emacs-mcx.transformToLowercase",(e=>e.runCommand("transformToLowercase"))),s("emacs-mcx.transformToTitlecase",(e=>e.runCommand("transformToTitlecase"))),s("emacs-mcx.deleteBlankLines",(e=>e.runCommand("deleteBlankLines"))),s("emacs-mcx.recenterTopBottom",(e=>e.runCommand("recenterTopBottom"))),s("emacs-mcx.tabToTabStop",(e=>e.runCommand("tabToTabStop"))),s("emacs-mcx.deleteIndentation",(e=>e.runCommand("deleteIndentation"))),s("emacs-mcx.paredit.forwardSexp",(e=>e.runCommand("paredit.forwardSexp"))),s("emacs-mcx.paredit.forwardDownSexp",(e=>e.runCommand("paredit.forwardDownSexp"))),s("emacs-mcx.paredit.backwardSexp",(e=>e.runCommand("paredit.backwardSexp"))),s("emacs-mcx.paredit.backwardUpSexp",(e=>e.runCommand("paredit.backwardUpSexp"))),s("emacs-mcx.paredit.markSexp",(e=>e.runCommand("paredit.markSexp"))),s("emacs-mcx.paredit.killSexp",(e=>e.runCommand("paredit.killSexp"))),s("emacs-mcx.paredit.pareditKill",(e=>e.runCommand("paredit.pareditKill"))),s("emacs-mcx.paredit.backwardKillSexp",(e=>e.runCommand("paredit.backwardKillSexp"))),s("emacs-mcx.copyToRegister",(e=>e.runCommand("copyToRegister"))),s("emacs-mcx.insertRegister",(e=>e.runCommand("insertRegister"))),s("emacs-mcx.copyRectangleToRegister",(e=>e.runCommand("copyRectangleToRegister"))),s("emacs-mcx.pointToRegister",(e=>e.runCommand("pointToRegister"))),s("emacs-mcx.jumpToRegister",(e=>e.runCommand("jumpToRegister"))),s("emacs-mcx.registerNameCommand",((e,...t)=>e.runCommand("registerNameCommand",t))),s("emacs-mcx.executeCommandWithPrefixArgument",((e,t)=>{if("object"==typeof t&&null!=t&&!Array.isArray(t))return"string"!=typeof(null==t?void 0:t.command)||"string"!=typeof(null==t?void 0:t.prefixArgumentKey)&&null!=(null==t?void 0:t.prefixArgumentKey)?void 0:e.executeCommandWithPrefixArgument(t.command,t.args,t.prefixArgumentKey)}))},t.deactivate=function(){};const a=o(n(398)),c=n(202),l=n(915),u=n(74),d=n(290),h=n(128),m=n(614),g=n(247),p=n(387)},653:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),o=0;o<n.length;o++)"default"!==n[o]&&i(t,e,n[o]);return s(t,e),t}),a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.KillYanker=t.AppendDirection=void 0;const c=o(n(398)),l=n(398),u=n(247),d=n(185),h=n(499),m=n(306);Object.defineProperty(t,"AppendDirection",{enumerable:!0,get:function(){return m.AppendDirection}});const g=n(614),p=n(253),f=n(273);t.KillYanker=class{get textEditor(){return this.emacsController.textEditor}constructor(e,t,n){this.isAppending=!1,this.docChangedAfterYank=!1,this.emacsController=e,this.killRing=t,this.minibuffer=n,this.docChangedAfterYank=!1,this.prevKillPositions=[],this.prevYankPositions=[],this.textChangeCount=0,this.prevYankChanges=0,this.disposables=[],c.workspace.onDidChangeTextDocument(this.onDidChangeTextDocument,this,this.disposables),c.window.onDidChangeTextEditorSelection(this.onDidChangeTextEditorSelection,this,this.disposables)}dispose(){for(const e of this.disposables)e.dispose()}onDidChangeTextDocument(e){e.document.uri.toString()===this.textEditor.document.uri.toString()&&(this.docChangedAfterYank=!0,this.isAppending=!1),this.textChangeCount++}onDidChangeTextEditorSelection(e){e.textEditor===this.textEditor&&(this.docChangedAfterYank=!0,this.isAppending=!1)}kill(e,t){return a(this,arguments,void 0,(function*(e,t,n=m.AppendDirection.Forward){(0===e.length||e.some((e=>e.isEmpty)))&&(this.isAppending=!1),(0,d.equalPositions)(this.getCursorPositions(),this.prevKillPositions)||(this.isAppending=!1),yield this.copy(e,t,this.isAppending,n),yield this.delete(e,t),this.isAppending=!0,this.prevKillPositions=this.getCursorPositions()}))}copy(e,t){return a(this,arguments,void 0,(function*(e,t,n=!1,r=m.AppendDirection.Forward){const i=new m.EditorTextKillRingEntity(e.map((e=>({range:e,text:t?(0,p.getRectText)(this.textEditor.document,e):this.textEditor.document.getText(e),rectMode:t}))),this.textEditor.document.eol);if(null!==this.killRing){const e=this.killRing.getTop();n&&e instanceof m.EditorTextKillRingEntity?(e.append(i,r),yield c.env.clipboard.writeText(e.asString())):(this.killRing.push(i),yield c.env.clipboard.writeText(i.asString()))}else yield c.env.clipboard.writeText(i.asString())}))}cancelKillAppend(){this.isAppending=!1}pasteString(e){return a(this,void 0,void 0,(function*(){if(!this.minibuffer.isReading)return c.commands.executeCommand("paste",{text:e});this.minibuffer.paste(e)}))}pasteKillRingEntity(e){return a(this,void 0,void 0,(function*(){const t=e.asString();if(this.minibuffer.isReading)this.minibuffer.paste(t);else{if("editor"===e.type){const n=this.textEditor.selections,r=e.getRegionTextsList(),i=r.length>1&&t.split("\n").length!==r.length,s=r.length===n.length;if(i&&s||e.hasRectModeText())return s||(this.textEditor.selections=[this.textEditor.selection]),void((yield this.textEditor.edit((e=>{n.forEach(((t,n)=>{t.isEmpty||e.delete(t);const i=r[n];let s=t.start,o="";i.forEach((t=>{const n=s.character;if(t.rectMode){const r=t.range.end.line-t.range.start.line,i=t.range.end.character-t.range.start.character;t.text.split(/\r?\n/).forEach(((t,r)=>{const a=t.length,c=s.line+r;if(c<this.textEditor.document.lineCount){const r=this.textEditor.document.lineAt(c).range.end.character,o=" ".repeat(Math.max(n-r,0))+t+" ".repeat(Math.max(i-a,0));e.insert(new l.Position(c,s.character),o)}else{const e=" ".repeat(n)+t+" ".repeat(i-a);o+=(0,f.getEolChar)(this.textEditor.document.eol)+e}})),s=new l.Position(s.line+r,s.character)}else s.line<this.textEditor.document.lineCount?e.insert(s,t.text):o+=t.text}));const a=this.textEditor.document.lineAt(this.textEditor.document.lineCount-1).range.end;e.insert(a,o)}))})))||g.logger.warn("Failed to paste kill ring entity"))}yield c.commands.executeCommand("paste",{text:t})}}))}yank(){return a(this,void 0,void 0,(function*(){if(null===this.killRing){const e=yield c.env.clipboard.readText();return this.pasteString(e)}const e=yield c.env.clipboard.readText();let t=this.killRing.getTop();if(null==t||!t.isSameClipboardText(e)){const n=new h.ClipboardTextKillRingEntity(e);this.killRing.push(n),t=n}this.textChangeCount=0,yield this.pasteKillRingEntity(t),this.prevYankChanges=this.textChangeCount,this.docChangedAfterYank=!1,this.prevYankPositions=this.textEditor.selections.map((e=>e.active))}))}yankPop(){return a(this,void 0,void 0,(function*(){if(null===this.killRing)return;if(this.isYankInterrupted())return void u.MessageManager.showMessage("Previous command was not a yank");const e=this.killRing.getTop(),t=this.killRing.popNext();if(null!=t){if(null!=e&&!e.isEmpty()&&this.prevYankChanges>0)for(let e=0;e<this.prevYankChanges;++e)yield c.commands.executeCommand("undo");this.textChangeCount=0,yield this.pasteKillRingEntity(t),this.prevYankChanges=this.textChangeCount,this.docChangedAfterYank=!1,this.prevYankPositions=this.textEditor.selections.map((e=>e.active))}}))}delete(e,t){return a(this,arguments,void 0,(function*(e,t,n=3){const r=this.emacsController.inRectMarkMode&&this.emacsController.nativeSelections.map((e=>{const t=e.active.line,n=Math.min(e.active.character,e.anchor.character);return new c.Selection(t,n,t,n)})),i=t?e.flatMap((e=>(0,p.convertSelectionToRectSelections)(this.textEditor.document,new c.Selection(e.start,e.end)))):e;let s=!1,o=0;for(;!s&&o<n;)s=yield this.textEditor.edit((e=>{i.forEach((t=>{e.delete(t)})),r&&(this.emacsController.exitMarkMode(),this.textEditor.selections=r)})),o++;return s}))}isYankInterrupted(){if(this.docChangedAfterYank)return!0;const e=this.getCursorPositions();return!(0,d.equalPositions)(e,this.prevYankPositions)}getCursorPositions(){return this.emacsController.inRectMarkMode?this.emacsController.nativeSelections.map((e=>e.active)):this.textEditor.selections.map((e=>e.active))}}},499:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ClipboardTextKillRingEntity=void 0,t.ClipboardTextKillRingEntity=class{constructor(e){this.type="clipboard",this.text=e}isSameClipboardText(e){return e===this.text}isEmpty(){return""===this.text}asString(){return this.text}}},306:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EditorTextKillRingEntity=t.AppendDirection=void 0;const r=n(273);var i;!function(e){e[e.Forward=0]="Forward",e[e.Backward=1]="Backward"}(i||(t.AppendDirection=i={}));class s{constructor(e){this.regionTexts=[e]}forEach(e){this.regionTexts.forEach(e)}append(e,t=i.Forward){t===i.Forward?this.regionTexts=this.regionTexts.concat(e.regionTexts):this.regionTexts=e.regionTexts.concat(this.regionTexts)}isEmpty(){return this.regionTexts.every((e=>""===e.text))}getAppendedText(){return this.regionTexts.map((e=>e.text)).join("")}getLastRange(){return this.regionTexts[this.regionTexts.length-1].range}hasRectModeText(){return this.regionTexts.some((e=>e.rectMode))}}t.EditorTextKillRingEntity=class{constructor(e,t){this.type="editor",this.regionTextsList=e.map((e=>new s(e))),this.eolChar=(0,r.getEolChar)(t)}isSameClipboardText(e){return this.asString()===e}isEmpty(){return this.regionTextsList.every((e=>e.isEmpty()))}asString(){const e=this.regionTextsList.map((e=>({range:e.getLastRange(),text:e.getAppendedText()}))).sort(((e,t)=>e.range.start.line===t.range.start.line?e.range.start.character-t.range.start.character:e.range.start.line-t.range.start.line));let t="";return e.forEach(((n,r)=>{const i=e[r-1];i&&i.range.start.line!==n.range.start.line?t+=this.eolChar+n.text:t+=n.text})),t}getRegionTextsList(){return this.regionTextsList}append(e,t=i.Forward){const n=e.getRegionTextsList();if(n.length!==this.regionTextsList.length)throw Error("Not appendable");this.regionTextsList.map(((e,r)=>e.append(n[r],t)))}hasRectModeText(){return this.regionTextsList.some((e=>e.hasRectModeText()))}}},128:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KillRing=void 0,t.KillRing=class{constructor(e=60){this.maxNum=60,e&&(this.maxNum=e),this.pointer=null,this.killRing=[]}push(e){this.killRing=[e].concat(this.killRing),this.killRing.length>this.maxNum&&(this.killRing=this.killRing.slice(0,this.maxNum)),this.pointer=0}getTop(){if(null!==this.pointer&&0!==this.killRing.length)return this.killRing[this.pointer]}popNext(){if(null!==this.pointer&&0!==this.killRing.length)return this.pointer=(this.pointer+1)%this.killRing.length,this.killRing[this.pointer]}}},614:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logger=t.Logger=void 0;const r=n(91);class i{static get(e){let t=i.cache.get(e);return void 0===t&&(t=r.LoggerImpl.get(e),i.configuration&&t.configChanged(i.configuration),i.cache.set(e,t)),t}static configChanged(e){i.configuration=e;for(const t of this.cache.values())t.configChanged(e)}}t.Logger=i,i.cache=new Map,i.configuration=void 0,t.logger=i.get("")},506:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MarkRing=void 0,t.MarkRing=class{constructor(e){this.maxNum=16,e&&(this.maxNum=e),this.pointer=null,this.ring=[]}push(e,t=!1){t?this.ring[0]=e:(this.ring=[e].concat(this.ring),this.ring.length>this.maxNum&&(this.ring=this.ring.slice(0,this.maxNum))),this.pointer=0}getTop(){if(null!=this.pointer&&0!==this.ring.length)return this.ring[this.pointer]}pop(){if(null==this.pointer||0===this.ring.length)return;const e=this.ring[this.pointer];return this.pointer=(this.pointer+1)%this.ring.length,e}}},247:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),o=0;o<n.length;o++)"default"!==n[o]&&i(t,e,n[o]);return s(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.MessageManager=void 0;const a=o(n(398));class c{static get instance(){return this.inst||(this.inst=new c),this.inst}static registerDispose(e){e.subscriptions.push(this.instance)}static showMessage(e){this.instance.showMessage(e)}static removeMessage(){this.instance.removeMessage()}constructor(e=1e4){this.messageDisposable=null,this.disposables=[],this.timeout=e,this.onInterrupt=this.onInterrupt.bind(this),a.window.onDidChangeActiveTerminal(this.onInterrupt,this,this.disposables),a.window.onDidChangeActiveTextEditor(this.onInterrupt,this,this.disposables),a.window.onDidChangeTextEditorOptions(this.onInterrupt,this,this.disposables),a.window.onDidChangeTextEditorSelection(this.onInterrupt,this,this.disposables),a.window.onDidChangeTextEditorViewColumn(this.onInterrupt,this,this.disposables),a.window.onDidChangeTextEditorVisibleRanges(this.onInterrupt,this,this.disposables),a.window.onDidChangeVisibleTextEditors(this.onInterrupt,this,this.disposables),a.window.onDidChangeWindowState(this.onInterrupt,this,this.disposables),a.window.onDidCloseTerminal(this.onInterrupt,this,this.disposables),a.window.onDidOpenTerminal(this.onInterrupt,this,this.disposables),a.workspace.onDidChangeConfiguration(this.onInterrupt,this,this.disposables),a.workspace.onDidChangeTextDocument(this.onInterrupt,this,this.disposables),a.workspace.onDidChangeWorkspaceFolders(this.onInterrupt,this,this.disposables),a.workspace.onDidCloseTextDocument(this.onInterrupt,this,this.disposables),a.workspace.onDidOpenTextDocument(this.onInterrupt,this,this.disposables),a.workspace.onDidSaveTextDocument(this.onInterrupt,this,this.disposables),a.workspace.onWillSaveTextDocument(this.onInterrupt,this,this.disposables)}onInterrupt(){null!==this.messageDisposable&&(this.messageDisposable.dispose(),this.messageDisposable=null)}showMessage(e){this.messageDisposable&&this.messageDisposable.dispose(),this.messageDisposable=a.window.setStatusBarMessage(e,this.timeout)}removeMessage(){null!==this.messageDisposable&&this.messageDisposable.dispose()}dispose(){null!==this.messageDisposable&&this.messageDisposable.dispose();for(const e of this.disposables)e.dispose()}}t.MessageManager=c},387:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.InputBoxMinibuffer=void 0;const s=i(n(398)),o=n(614);t.InputBoxMinibuffer=class{constructor(){this.inputBox=void 0}get isReading(){return null!=this.inputBox&&this.inputBox.enabled&&!this.inputBox.busy}paste(e){this.isReading&&null!=this.inputBox&&this.inputBox.enabled?this.inputBox.busy?o.logger.warn("Minibuffer is busy"):this.inputBox.value=this.inputBox.value+e:o.logger.warn("Minibuffer is not active.")}readFromMinibuffer(e){return r(this,void 0,void 0,(function*(){yield this.setMinibufferReading(!0);const t=s.default.window.createInputBox();this.inputBox=t,t.title=e.prompt,t.show();const n=()=>{this.setMinibufferReading(!1),t.dispose(),this.inputBox=void 0};return new Promise((e=>{let r=!1;t.onDidAccept((()=>{if(r)return;r=!0;const i=t.value;n(),e(i)})),t.onDidHide((()=>{r||(r=!0,n(),e(void 0))}))}))}))}setMinibufferReading(e){return s.default.commands.executeCommand("setContext","emacs-mcx.minibufferReading",e)}}},91:function(e,t){"use strict";var n=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.LoggerImpl=t.VsCodeMessage=void 0;const r=["error","warn","info","verbose","debug","silly"];class i{constructor(e){this.actionMessages=["Dismiss","Suppress Errors"],this.prefix=e,this.priorityThreshold=-1}error(e){this.log({level:"error",message:e})}debug(e){this.log({level:"debug",message:e})}warn(e){this.log({level:"warn",message:e})}verbose(e){this.log({level:"verbose",message:e})}isSevere(e){const t=r.indexOf(e);return t<0||this.priorityThreshold<0||t<=this.priorityThreshold}log(e){return n(this,void 0,void 0,(function*(){if(this.configuration&&this.configuration.debug.silent)return;if(!this.isSevere(e.level))return;let t;switch(e.level){case"error":t=console.error;break;case"warn":t=console.warn;break;case"info":t=console.log;break;case"verbose":case"debug":t=console.debug;break;default:throw Error(`Unsupported log level ${e.level}`)}t(`${this.prefix}: ${e.message}`,...this.actionMessages)}))}configChanged(e){var t;this.configuration=e,this.priorityThreshold=r.indexOf(null===(t=this.configuration)||void 0===t?void 0:t.debug.loggingLevelForConsole)}}t.VsCodeMessage=i,t.LoggerImpl=class{static get(e){return new i(e)}}},623:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PrefixArgumentHandler=void 0;const r=n(614),i=n(247);t.PrefixArgumentHandler=class{constructor(e,t){this.state={isInPrefixArgumentMode:!1,isAcceptingPrefixArgument:!1,cuCount:0,prefixArgumentStr:""},this.onPrefixArgumentChange=e,this.onAcceptingStateChange=t}updateState(e){const t=this.state;this.state=Object.assign(Object.assign({},this.state),e);const n=t.isAcceptingPrefixArgument!==this.state.isAcceptingPrefixArgument,r=t.isInPrefixArgumentMode!==this.state.isInPrefixArgumentMode||t.prefixArgumentStr!==this.state.prefixArgumentStr||t.cuCount!==this.state.cuCount,i=[];if(n){const e=this.onAcceptingStateChange(this.state.isAcceptingPrefixArgument);i.push(e)}if(r){const e=this.onPrefixArgumentChange(this.getPrefixArgument());i.push(e)}return Promise.all(i)}showPrefixArgumentMessage(){i.MessageManager.showMessage(`C-u ${this.state.prefixArgumentStr}-`)}subsequentArgumentDigit(e){if(!this.state.isInPrefixArgumentMode)return r.logger.debug("[PrefixArgumentHandler.subsequentArgumentDigit]\t Not in prefix argument mode. exit."),Promise.resolve();if(!this.state.isAcceptingPrefixArgument)return r.logger.debug("[PrefixArgumentHandler.subsequentArgumentDigit]\t Prefix argument input is not accepted."),Promise.resolve();if(isNaN(e)||e<0)return r.logger.debug("[PrefixArgumentHandler.subsequentArgumentDigit]\t Input digit is NaN or negative. Ignore it."),Promise.resolve();const t=e.toString(),n=this.updateState({prefixArgumentStr:this.state.prefixArgumentStr+t});return this.showPrefixArgumentMessage(),n}universalArgument(){return this.state.isInPrefixArgumentMode&&this.state.prefixArgumentStr.length>0?(r.logger.debug("[PrefixArgumentHandler.universalArgument]\t Stop accepting prefix argument."),this.updateState({isAcceptingPrefixArgument:!1})):(r.logger.debug("[PrefixArgumentHandler.universalArgument]\t Start prefix argument or count up C-u."),this.updateState({isInPrefixArgumentMode:!0,isAcceptingPrefixArgument:!0,cuCount:this.state.cuCount+1,prefixArgumentStr:""}))}digitArgument(e){if(isNaN(e)||e<0)return r.logger.debug("[PrefixArgumentHandler.digitArgument]\t Input digit is NaN or negative. Ignore it."),Promise.resolve();const t=e.toString(),n=this.updateState({isInPrefixArgumentMode:!0,isAcceptingPrefixArgument:!0,cuCount:0,prefixArgumentStr:t});return this.showPrefixArgumentMessage(),n}negativeArgument(){if(""!==this.state.prefixArgumentStr)return r.logger.warn("[PrefixArgumentHandler.negativeArgument]\t Invalid invocation of negative-argument."),Promise.resolve();const e=this.updateState({isInPrefixArgumentMode:!0,isAcceptingPrefixArgument:!0,cuCount:0,prefixArgumentStr:"-"});return this.showPrefixArgumentMessage(),e}get minusSignAcceptable(){return this.state.isAcceptingPrefixArgument&&""===this.state.prefixArgumentStr}cancel(){return r.logger.debug("[PrefixArgumentHandler.cancel]"),this.updateState({isInPrefixArgumentMode:!1,isAcceptingPrefixArgument:!1,cuCount:0,prefixArgumentStr:""})}getPrefixArgument(){if(!this.state.isInPrefixArgumentMode)return;if("-"===this.state.prefixArgumentStr)return-1;const e=parseInt(this.state.prefixArgumentStr,10);return isNaN(e)?Math.pow(4,this.state.cuCount):e}precedingSingleCtrlU(){return this.state.isInPrefixArgumentMode&&1===this.state.cuCount}}},861:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PromiseDelegate=void 0,t.PromiseDelegate=class{constructor(){this._promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}get promise(){return this._promise}resolvePromise(e){this.resolve(e)}rejectPromise(e){this.reject(e)}}},253:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),o=0;o<n.length;o++)"default"!==n[o]&&i(t,e,n[o]);return s(t,e),t}),a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.convertSelectionToRectSelections=m,t.getRectText=function(e,t){return m(e,new c.Selection(t.start,t.end)).map((t=>e.getText(t))).join((0,l.getEolChar)(e.eol))},t.copyOrDeleteRect=function(e,t,n){return a(this,void 0,void 0,(function*(){const r=(0,u.getNonEmptySelections)(t);if(1!==r.length)return null;const i=r[0],s=new c.Selection(i.start,i.end),o=m(t.document,s);let a=null;return n.copy&&(a=o.map((e=>t.document.getText(e)))),n.delete&&(yield(0,h.deleteRanges)(t,o),(0,d.revealPrimaryActive)(t)),e.exitMarkMode(),(0,u.makeSelectionsEmpty)(t),a}))},t.insertRect=function(e,t){return a(this,void 0,void 0,(function*(){if(0===t.length)return;const n=t.length-1,r=t[n].length,i=e.selection.active;yield e.edit((r=>{const s=e.document.lineCount-1,o=i.character,a=(0,l.getEolChar)(e.document.eol);let u=0;for(;u<=n;){const n=i.line+u;if(n>s)break;const a=Math.max(0,o-e.document.lineAt(n).range.end.character),l=" ".repeat(a)+t[u];r.insert(new c.Position(n,o),l),++u}if(u<=n){const n=t.slice(u).map((e=>a+" ".repeat(o)+e)).join(""),i=e.document.lineAt(s).range.end;r.insert(i,n)}}));const s=i.translate(n,r);e.selection=new c.Selection(s,s)}))};const c=o(n(398)),l=n(273),u=n(11),d=n(40),h=n(185);function m(e,t){const n=[],r=Math.max(t.start.line,0),i=Math.min(t.end.line,e.lineCount-1);for(let s=r;s<=i;s++){const r=e.lineAt(s).range.end.character;n.push(new c.Selection(s,Math.min(t.anchor.character,r),s,Math.min(t.active.character,r)))}return t.active.line<t.anchor.line&&n.reverse(),n}},185:function(e,t){"use strict";var n=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.equalPositions=function(e,t){return e.length===t.length&&e.every(((e,n)=>e.isEqual(t[n])))},t.delay=function(e){return new Promise((t=>setTimeout(t,e)))},t.deleteRanges=function(e,t){return n(this,arguments,void 0,(function*(e,t,n=3){let r=!1,i=0;for(;!r&&i<n;)r=yield e.edit((e=>{t.forEach((t=>{e.delete(t)}))})),i++;return r}))}},964:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toUint8=function(e){return e<0?0:e>255?255:0|e},t.toUint32=function(e){return e<0?0:e>4294967295?4294967295:0|e}},165:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMapForWordSeparators=t.WordCharacterClassifier=void 0;const r=n(774);class i extends r.CharacterClassifier{constructor(e){super(0);for(let t=0,n=e.length;t<n;t++)this.set(e.charCodeAt(t),2);this.set(32,1),this.set(9,1)}}t.WordCharacterClassifier=i,t.getMapForWordSeparators=function(e){let t={};return e=>(t.hasOwnProperty(e)||(t[e]=(e=>new i(e))(e)),t[e])}()},774:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CharacterSet=t.CharacterClassifier=void 0;const r=n(964);class i{constructor(e){let t=(0,r.toUint8)(e);this._defaultValue=t,this._asciiMap=i._createAsciiMap(t),this._map=new Map}static _createAsciiMap(e){let t=new Uint8Array(256);for(let n=0;n<256;n++)t[n]=e;return t}set(e,t){let n=(0,r.toUint8)(t);e>=0&&e<256?this._asciiMap[e]=n:this._map.set(e,n)}get(e){return e>=0&&e<256?this._asciiMap[e]:this._map.get(e)||this._defaultValue}}t.CharacterClassifier=i,t.CharacterSet=class{constructor(){this._actual=new i(0)}add(e){this._actual.set(e,1)}has(e){return 1===this._actual.get(e)}}},4:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(265),t)},74:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),o=0;o<n.length;o++)"default"!==n[o]&&i(t,e,n[o]);return s(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.WorkspaceConfigCache=t.WorkspaceConfigSectionCache=void 0;const a=o(n(398));class c{get data(){return this._data}constructor(e){this._data=a.workspace.getConfiguration(e),this.eventListenerDisposable=a.workspace.onDidChangeConfiguration((t=>{t.affectsConfiguration(e)&&(this._data=a.workspace.getConfiguration(e))}),this)}dispose(){this.eventListenerDisposable.dispose()}}t.WorkspaceConfigSectionCache=c;class l{constructor(){this.configSections={}}static get instance(){return this.inst||(this.inst=new l),this.inst}get(e){const t=this.configSections[e];if(null!=t)return t.data;const n=new c(e);return this.configSections[e]=n,n.data}static get(e){return this.instance.get(e)}dispose(){for(const e of Object.values(this.configSections))e.dispose()}}t.WorkspaceConfigCache=l},345:(e,t,n)=>{!function(){var t=e.exports,r=t?e.exports:window.paredit={};t&&(r.reader=n(350).reader,r.navigator=n(448).navigator,r.walk=n(448).walk,r.editor=n(720).editor,r.specialForms=n(720).specialForms),r.parse=function(e,t){var n=!(t=t||{}).hasOwnProperty("addSourceForLeafs")||t.addSourceForLeafs,i=[],s=r.reader.readSeq(e,(function(t,r,s,o,a){var c={type:t,start:s.idx,end:o.idx};return"error"===t?(c.error=r.error,r.children&&(c.children=r.children),i.push(c)):n&&"list"!==t&&(c.source=e.slice(c.start,c.end)),"list"===t&&(c.children=r),("list"===t||"string"===t||"error"===t&&a)&&(c.open=a.open,c.close=a.close),c}));return{type:"toplevel",start:0,end:s&&s.length&&s[s.length-1].end||0,errors:i,children:s}}}()},720:(e,t,n)=>{!function(t){var r=e.exports,i=r?e.exports:window.paredit,s=r?n(833).util:window.paredit.util;r?n(448).navigator:window.paredit.navigator,function(e,t,n,r){r.specialForms=["&","monitor-exit",/^case/,"try",/^reify/,"finally",/^(.*-)?loop/,/^do/,/^let/,/^import/,"new",/^deftype/,/^let/,"fn","recur",/^set.*!$/,".","var","quote","catch","throw","monitor-enter","ns","in-ns",/^([^\/]+\/)?def/,/^if/,/^when/,/^unless/,/->/,"while","for",/(^|\/)with/,"testing","while","cond","condp","apply","binding","locking","proxy","reify",/^extend/,"facts"];var i=r.editor={rewrite:function(e,r,i){var s=i.length?a(i).end-r.end:r.start-r.end;return t.containingSexpsAt(e,r.start).reduceRight((function(e,t){var r,i=t.children.indexOf(e.original);return r=i>-1?t.children.slice(0,i).concat(e.nodes).concat(t.children.slice(i+1).map(l.bind(null,s))):t.children,{original:t,nodes:[n.merge(t,{end:t.end+s,children:r})]}}),{original:r,nodes:i}).nodes[0]},openList:function(e,n,r,i){(i=i||{}).count;var s=i.open||"(",o=i.close||")";if(i.freeEdits||e.errors&&e.errors.length)return{changes:[["insert",r,s]],newIndex:r+s.length};var c=a(t.containingSexpsAt(e,r));if(c&&"comment"===c.type||"string"===c.type)return{changes:[["insert",r,s]],newIndex:r+s.length};if(!i.endIdx)return{changes:[["insert",r,s+o]],newIndex:r+s.length};var l=a(t.containingSexpsAt(e,r,t.hasChildren)),u=a(t.containingSexpsAt(e,i.endIdx,t.hasChildren));if(l!==u)return{changes:[["insert",r,s+o]],newIndex:r+s.length};var d=u.children.filter((function(e){return e.start<r&&r<e.end})),h=u.children.filter((function(e){return e.start<i.endIdx&&i.endIdx<e.end})),m=d[0]&&d[0]!==h[0]&&(h[0]||"symbol"!==d[0].type),g=h[0]&&d[0]!==h[0]&&(d[0]||"symbol"!==h[0].type),p=m?d[0].end:r;return{changes:[["insert",g?h[0].start:i.endIdx,o],["insert",p,s]],newIndex:p+s.length}},spliceSexp:function(e,n,r){var i=t.containingSexpsAt(e,r,t.hasChildren);if(!i.length)return null;var s=i.pop(),o="toplevel"===s.type,a=s.children.filter((function(e){return e.start<r&&r<e.end}))[0],c=a&&"string"===a.type,l=[],u=r;return o||l.push(["remove",s.end-1,s.close.length]),c&&(l.push(["remove",a.end-1,a.close.length]),l.push(["remove",a.start,a.open.length]),u-=a.open.length),o||(l.push(["remove",s.start,s.open.length]),u-=s.open.length),{changes:l,newIndex:u}},spliceSexpKill:function(e,n,r,s){(s=s||{}).count;var o=s.backward,c=t.containingSexpsAt(e,r,t.hasChildren);if(!c.length)return null;if(o)var l=u(a(c),r),h=i.killSexp(e,n,r,{count:l.length,backward:!0});else{var m=d(a(c),r);h=i.killSexp(e,n,r,{count:m.length,backward:!1})}var g=i.spliceSexp(e,n,r);if(!h)return g;if(!g)return h;var p=Array.prototype.slice.call(g.changes);return 2===p.length?p.splice(1,0,h.changes[0]):4===p.length&&p.splice(2,0,h.changes[0]),{changes:p,newIndex:h.newIndex-(3===p.length?1:2)}},splitSexp:function(e,n,r){var i=t.containingSexpsAt(e,r);if(!i.length)return null;var s=i.pop();return"toplevel"===s.type?null:t.hasChildren(s)||"string"===s.type?{changes:[["insert",r,s.close+" "+s.open]],newIndex:r+s.close.length}:null},killSexp:function(e,n,r,i){var s=(i=i||{}).count||1,o=i.backward,c=t.containingSexpsAt(e,r,t.hasChildren);if(!c.length)return null;var l=c.pop(),h=l.children.filter((function(e){return e.start<r&&r<e.end}))[0];if(h){var m=o?h.start:r,g=o?r:h.end;return"string"===h.type&&(m+=o?h.open.length:0,g+=o?0:-h.close.length),{changes:[["remove",m,g-m]],newIndex:m}}if(h&&"string"===h.type)return{changes:[["remove",m=o?h.start+h.open.length:r,(g=o?r:h.end-h.close.length)-m]],newIndex:m};if(o){var p=u(l,r);if(!p.length)return null;var f=p.slice(-s)[0].start,v=[["remove",f,r-f]],x=f}else{var w=d(l,r);if(!w.length)return null;x=r,v=[["remove",r,a(w.slice(0,s)).end-r]]}return{changes:v,newIndex:x}},wrapAround:function(e,n,r,i,s,o){var c=o&&o.count||1,l=t.containingSexpsAt(e,r,t.hasChildren);if(!l.length)return null;var u=a(l),d=a(u.children.filter((function(e){return e.start>=r})).slice(0,c));return{changes:[["insert",r,i],["insert",(d?d.end:r)+i.length,s]],newIndex:r+i.length}},closeAndNewline:function(e,n,r,i){i=i||")";var s=t.containingSexpsAt(e,r,(function(e){return t.hasChildren(e)&&e.close===i}));if(!s.length)return null;var l=a(s),u="\n"+c(o(n,l.start)," ");return{changes:[["insert",l.end,u]],newIndex:l.end+u.length}},barfSexp:function(e,n,r,i){var s=i&&i.backward,o=t.containingSexpsAt(e,r,t.hasChildren);if(!o.length)return null;var c=a(o),l=a(t.containingSexpsAt(e,r));if(l===c&&(l=null),s){var h=u(c,r);if(!h.length)return null;var m=[["insert",h[1]?h[1].start:l?l.start:r,c.open],["remove",c.start,c.open.length]]}else{var g=d(c,r);if(!g.length)return null;m=[["remove",c.end-c.close.length,c.close.length],["insert",g[g.length-2]?g[g.length-2].end:l?l.end:r,c.close]]}return{changes:m,newIndex:r}},slurpSexp:function(e,n,r,i){var s=i&&i.backward,o=i.count||1,c=t.containingSexpsAt(e,r,t.hasChildren);if(c.length<2)return null;var l=c.pop(),h=c.pop();if(s){var m=u(h,r);if(!m.length)return null;var g=[["remove",l.start,l.open.length],["insert",m.slice(-o)[0].start,l.open]]}else{var p=d(h,r);if(!p.length)return null;g=[["insert",a(p.slice(0,o)).end,l.close],["remove",l.end-l.close.length,l.close.length]]}return{changes:g,newIndex:r}},transpose:function(e,n,r,i){i=i||{};var s=a(t.containingSexpsAt(e,r,t.hasChildren)),o=u(s,r),c=d(s,r),l=s.children.find((function(e){return e.start<r&&r<e.end}));if(l&&(c=[l]),!o.length||!c.length)return null;var h=a(o),m=c[0],g=n.slice(h.end,m.start)+t.source(n,h);return{changes:[["insert",m.end,g],["remove",h.start,m.start-h.start]],newIndex:r-(h.end-h.start)+(m.end-m.start)}},delete:function(e,n,r,i){var s=(i=i||{}).count||1,o=!!i.backward,c=i.endIdx;if(i.freeEdits||e.errors&&e.errors.length)return c?{changes:[["remove",r,c-r]],newIndex:r}:{changes:[["remove",o?r-s:r,s]],newIndex:o?r-s:r};var l=t.containingSexpsAt(e,r),h=l.filter((function(e){return t.hasChildren(e)})),m=a(h),g=a(l);if("number"==typeof c){if(m!==a(t.containingSexpsAt(e,c,t.hasChildren)))return null;var p=a(t.sexpsAt(m,r)),f=a(t.sexpsAt(m,c)),v=!O(p)&&p.start===r,x=!O(f)&&f.end===c;if(p===f&&(v&&!x||!v&&x))return null;if((f!==m&&!O(f)&&!x||p!==m&&!O(p)&&!v)&&p!==f)return null;if(-1===m.children.indexOf(p)&&p!==m||-1===m.children.indexOf(f)&&f!==m)return null;var w=Math.min(r,c);return{changes:[["remove",w,Math.max(r,c)-w]],newIndex:w}}var y,C=m===g,M=C&&u(m,r),b=C&&d(m,r),R={changes:[],newIndex:r},S={changes:[],newIndex:r-1},k={changes:[["remove",o?r-s:r,s]],newIndex:o?r-s:r};if(!C&&"comment"===g.type)return k;if(M&&M.length&&o)return(y=a(M)).end!==r||O(y)?k:_(y)||"char"===y.type?E(y):1==s?S:R;if(b&&b.length&&!o)return(y=b[0]).start!==r||O(y)?k:_(y)||"char"===y.type?E(y):R;C||(m=g);var A=r===m.start+(m.open?m.open.length:0),P=r===m.end-(m.close?m.close.length:0);return m.children&&m.children.length||!(A&&o||P&&!o)?A&&o&&(C?m.children.length:m.end-m.start>1)||P&&!o&&(C?m.children.length:m.end-m.start>1)?R:k:E(m);function _(e){return("string"===e.type||"list"===e.type)&&e.end-e.start===e.open.length+e.close.length}function E(e){return{changes:[["remove",e.start,e.end-e.start]],newIndex:e.start}}function O(e){return"symbol"===e.type||"comment"===e.type||"number"===e.type||"special"===e.type}},indentRange:function(e,h,m,g){var p=s(h,m),f=h.slice(g).indexOf("\n");return f=f>-1?f+g:h.length,h.slice(p,f).split("\n").reduce((function(e,s){var h=e.idx,m=e.changes,g=e.ast,p=e.src,f=a(t.containingSexpsAt(g,h,t.hasChildren)),v=f&&a(t.sexpsAt(g,h));if(!f)return{idx:h+s.length+1,newIndex:h,changes:m,ast:g,src:p};var x=s.match(/^\s*/)[0],w=v&&"string"===v.type&&h>v.start?0:function(e,n,i){if("toplevel"===n.type)return 0;var s=u(n,i);return function(e,n){if(!t.hasChildren(e)||!e.children.length)return!1;var i=e.children[0].source;return!!i&&r.specialForms.some((function(t){return"string"==typeof t?t===i:"function"==typeof t?t(i,e.children[0]):t instanceof RegExp&&t.test(i)}))}(n)?o(e,n.start+n.open.length+1):s.length<=1||"("!==n.open?o(e,n.start+n.open.length):o(e,s[1].start)}(p,f,h)-x.length,y=s.length+w;if(w>0){var C=c(w," ");m.push(["insert",h,C]),p=p.slice(0,h)+C+p.slice(h)}else w<0&&(m.push(["remove",h,-w]),p=p.slice(0,h)+p.slice(h-w));var M=d(f,h)[0];if(M){var b=l(w,M);g=i.rewrite(g,M,[b])}else g=i.rewrite(g,f,[n.merge(f,{end:f.end+w})]);return{idx:h+y+1,newIndex:h+w,changes:m,ast:g,src:p}}),{idx:p,changes:[],ast:e,src:h})}};function s(e,t){return e.slice(0,t).lastIndexOf("\n")+1}function o(e,t){return t-s(e,t)}function a(e){return e[e.length-1]}function c(e,t){return new Array(e+1).join(t)}function l(e,t){return n.mapTree(t,(function(t,r){return n.merge(t,{start:t.start+e,end:t.end+e,children:r})}),(function(e){return e.children}))}function u(e,t){return e.children.filter((function(e){return e.end<=t}))}function d(e,t){return e.children.filter((function(e){return t<=e.start}))}}(0,r?n(448).walk:window.paredit.walk,s,i)}()},448:(e,t,n)=>{!function(t){var r=e.exports,i=r?e.exports:window.paredit;!function(e,t){function n(e){return e[e.length-1]}var r=t.navigator={forwardSexp:function(e,t){var r=n(i.containingSexpsAt(e,t,(function(e){return!i.hasChildren(e)})));if(r)return r.end;var s=i.nextSexp(e,t);return s?s.end:t},backwardSexp:function(e,t){var r=n(i.containingSexpsAt(e,t,(function(e){return!i.hasChildren(e)})));if(r)return r.start;var s=i.prevSexp(e,t);return s?s.start:t},forwardDownSexp:function(e,t){var n=i.nextSexp(e,t,(function(e){return"list"===e.type}));return n?n.children&&n.children[0]?n.children[0].start:n.start+1:t},backwardUpSexp:function(e,t){var r=i.containingSexpsAt(e,t,(function(e){return"list"===e.type||"string"===e.type||"comment"===e.type}));return r&&r.length?n(r).start:t},closeList:function(e,t){var r=i.containingSexpsAt(e,t),s=n(r);return s&&"toplevel"!==s.type?"string"!==s.type&&"comment"!==s.type?n(r.filter(i.hasChildren)).end:void 0:t},sexpRange:function(e,t){return r.sexpRangeExpansion(e,t,t)},sexpRangeExpansion:function(t,r,o){if(r!==o){var a=n(i.sexpsAt(t,r,(function(e){return e.start===r}))),c=a&&n(i.sexpsAt(t,o,(function(e){return e.end===o})));if(a&&c){var l=n(i.sexpsAt(t,r,(function(e){return e.start<r&&!i.hasChildren(e)})));if(l)return[l.start,o];var u=n(i.sexpsAt(t,o,(function(e){return o<e.end&&!i.hasChildren(e)})));if(u)return[r,u.end]}}var d=n(e.flatFilterTree(t,(function(e){return"toplevel"!==e.type&&(r===o?e.start<=r&&o<=e.end:e.start===r?o<e.end:e.end===o?e.start<r:e.start<r&&o<e.end)}),s));if(!d)return null;var h=d.start===r||d.end===o;if("list"===d.type||"string"===d.type){if(h&&(r===d.start||o===d.end))return[d.start,d.end];if(d.start+1<r||o<d.end-1)return[d.start+1,d.end-1]}return[d.start,d.end]},rangeForDefun:function(e,t){var n=e.children&&e.children.filter((function(e){return e.start<=t&&t<=e.end}))[0];return n?[n.start,n.end]:null}},i=t.walk={hasChildren:function(e){return"list"===e.type||"toplevel"===e.type||"error"===e.type&&e.children},containingSexpsAt:function(t,n,r){return e.flatFilterTree(t,(function(e){return("toplevel"===e.type||"error"===e.type&&e.start<n&&n<=e.end||e.start<n&&n<e.end)&&(!r||r(e))}),s)},sexpsAt:function(t,n,r){return e.flatFilterTree(t,(function(e){return e.start<=n&&n<=e.end&&(!r||r(e))}),s)},nextSexp:function(t,r,o){var a=e.flatFilterTree(t,(function(e){return e.start<=r&&r<e.end&&i.hasChildren(e)}),s);if(!a.length)return null;var c=a.filter((function(e){return e.start===r&&"toplevel"!==e.type}))[0];if(c)return c;var l=n(a).children.filter((function(e){return r<=e.start&&(!o||!!o(e))}));return l.length?l[0]:null},prevSexp:function(t,r,o){var a=e.flatFilterTree(t,(function(e){return e.start<r&&r<=e.end&&i.hasChildren(e)}),s);if(!a.length)return null;var c=a.filter((function(e){return e.end===r&&"toplevel"!==e.type}))[0];if(c)return c;var l=n(a).children.filter((function(e){return e.end<=r&&(!o||!!o(e))}));return l.length?n(l):null},stringify:function(t){return e.mapTree(t,(function(n,r){return"list"===n.type||"toplevel"===n.type?"("+r.join(" ")+")":n.source?n.source:e.times(t.end-t.start,"x")}),(function(e){return e&&e.children||[]}))},source:function(e,t){return t.source?t.source:e.slice(t.start,t.end)}};function s(e){return e.children||[]}}(r?n(833).util:window.paredit.util,i)}()},350:e=>{!function(e){e.reader={setParentheses:function(e){return c(e)},readSeq:function(e,t){return u(null,e,Object.freeze([]),{idx:0,column:0,row:0},t).context},readSexp:function(e,t){return l(null,e,Object.freeze([]),{idx:0,column:0,row:0},t).context[0]}};var t,n,r,i,s={},o={},a=/[`@^#~]/;function c(e){t=e,n=Object.keys(t),r=n.map((function(e){return t[e]})),i=new RegExp("[^\\s"+Object.entries(t).map((function(e){return"\\"+e[0]+"\\"+e[1]})).join("")+',"\\\\`@^#~]')}function l(e,c,l,f,w){var y=c[0];if(!y&&e&&t[e])return{input:c,context:l,pos:f,flag:o};if(!y&&!t[e])return{input:c,context:l,pos:f,flag:o};if(/\s|,/.test(y))return{input:c.slice(1),context:l,pos:x(f,y)};if(a.test(y))return function(e,t,n,r){var i=p(n),s=e.slice(0,1),o=x(n,s),a=m(r,"special",s,i,o);return{pos:o,input:e.slice(1),context:t=t.concat([a])}}(c,l,f,w);if(";"===y)return function(e,t,n,r){for(var i=p(n),s="",o=e;o.length&&/^\s*;/.test(o);){var a=v(o);s+=a[0],o=a[1]}var c=x(n,s),l=m(r,"comment",s,i,c);return{pos:c,input:o,context:t=t.concat([l])}}(c,l,f,w);if('"'===y)return function(e,t,n,r){var i=!1,s=p(n),o=e[0];return n=x(n,e[0]),g(e=e.slice(1),n,(function(e){return!(!i&&'"'===e||(i?i=!1:"\\"===e&&(i=!0),0))}),(function(e,n,i,a){var c;if('"'==n[0])o=o+e+n[0],a=x(a,n[0]),n=n.slice(1),c=m(r,"string",o,s,a,{open:'"',close:'"'});else{var l=h("Expected '\"' but reached end of input",s,a,null);c=m(r,"error",l,i,a)}return{pos:a,input:n,context:t=t.concat([c])}}))}(c,l,f,w);if("\\"===y)return function(e,t,n,r){var i=p(n),s=e.slice(0,2),o=x(n,s),a=m(r,"char",s,i,o);return{pos:o,input:e.slice(2),context:t=t.concat([a])}}(c,l,f,w);if(/[0-9]/.test(y))return d(c,l,f,w);if("-"===y&&(/[0-9]/.test(c[1])||"."==c[1]&&/[0-9]/.test(c[2])))return d(c,l,f,w);if("."===y&&/[0-9]/.test(c[1]))return d(c,l,f,w);if(i.test(y))return function(e,t,n,r){return g(e,n,(function(e){return i.test(e)}),(function(e,n,i,s){var o=m(r,"symbol",e,i,s);return{pos:s,input:n,context:t=t.concat([o])}}))}(c,l,f,w);if(r.indexOf(y)>-1){if(!e){var C=function(e,t,n,i){return g(e,n,(function(e){return r.indexOf(e)>-1}),(function(e,n,r,s){var o=h("Unexpected input: '"+e+"'",r,s,null),a=m(i,"error",o,r,s);return{pos:s,input:n,context:t=t.concat([a])}}))}(c,l,f,w);return{input:C.input,context:C.context,pos:C.pos}}return{input:c,context:l,pos:f,flag:s}}if(n.indexOf(y)>-1){var M,b,R=p(f),S=u(y,c.slice(1),Object.freeze([]),x(f,y),w),k=S.input[0],A={open:y,close:t[y]};if(k!==t[y]){var P,_=p(S.pos);M=m(w,"error",P=h("Expected '"+t[y]+"'"+(k?" but got '"+k+"'":" but reached end of input"),R,_,S.context),R,_,A),b=k?x(S.pos,k):S.pos}else b=k?x(S.pos,k):S.pos,M=m(w,"list",S.context,R,b,A);return l=l.concat([M]),{input:S.input.slice(k?1:0),context:l,pos:b}}return P=m(w,"error",P=h("Unexpected character: "+y,R=p(f),_=x(f,y),null),R,_),l=l.concat([P]),{input:c.slice(1),context:l,pos:_}}function u(e,t,n,r,i){for(var a;;){var c=r.row,u=r.column;t=(a=l(e,t,n,r,i)).input,n=a.context,r=a.pos;var d=a.flag===o||a.flag===s&&(e||!t.length);if(!d&&r.row<=c&&r.column<=u)throw new Error("paredit reader cannot go forward at "+f(r)+" with input "+t);if(d)break}return{input:t,context:n,pos:r}}function d(e,t,n,r){var i=!0,s=!1;return g(e,n,(function(e){return!(!i||(i=!1,"-"!==e))||(s&&"."===e?(s=!1,!0):/[0-9.]/.test(e))}),(function(e,n,i,s){var o=m(r,"number",Number(e),i,s);return{pos:s,input:n,context:t=t.concat([o])}}))}function h(e,t,n,r){return{error:e+" at line "+(n.row+1)+" column "+n.column,start:p(t),end:p(n),children:r}}function m(e,t,n,r,i,s){return e?e(t,n,p(r),p(i),s):n}function g(e,t,n,r){for(var i=p(t),s="",o=0;o<e.length&&n(e[o]);o++)s+=e[o];return r(s,e.slice(s.length),i,x(t,s))}function p(e){return{idx:e.idx,column:e.column,row:e.row}}function f(e){return JSON.stringify(e)}function v(e){var t=e.indexOf("\n");return t=t>-1?t+1:e.length,[e.slice(0,t),e.slice(t)]}function x(e,t){if(!t)return e;e.idx+=t.length;var n=t.split("\n"),r=n.length;e.row+=r-1;var i=n[r-1].length;return e.column=r>1?i:e.column+i,e}c({"[":"]","(":")","{":"}"})}(e.exports?e.exports:window.paredit)},833:e=>{!function(e){var t=e.util={merge:function(e){return arguments.length>1?t.merge(Array.prototype.slice.call(arguments)):Array.isArray(e[0])?Array.prototype.concat.apply([],e):e.reduce((function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}),{})},mapTree:function(e,n,r){var i=(r(e)||[]).map((function(e){return t.mapTree(e,n,r)}));return n(e,i)},flatFilterTree:function(e,n,r){var i=[];return n(e)&&i.push(e),i.concat((r(e)||[]).reduce((function(e,i){return e.concat(t.flatFilterTree(i,n,r))}),[]))},last:function(e){return e[e.length-1]},times:function(e,t){return new Array(e+1).join(t)},clone:function(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t={};for(var n in e)t[n]=e[n];return t}}}(e.exports?e.exports:window.paredit)},398:e=>{"use strict";e.exports=require("vscode")}},t={},n=function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={exports:{}};return e[r].call(s.exports,s,s.exports,n),s.exports}(4),r=exports;for(var i in n)r[i]=n[i];n.__esModule&&Object.defineProperty(r,"__esModule",{value:!0})})();